import React from 'react';
import {Col,Form,Button,Icon, Select,InputNumber, AutoComplete} from 'antd';

import { DictionaryData,DictionaryLoader } from '../app/DictionaryLoader';
import { ApplyContent } from '../app/Model';

/**
  * 申请公用表单：设备管理
  */
 export default class ApplyFormEquipment extends React.Component<ApplyContent>{
    state:{equiptmentNames:Array<string>}={
        equiptmentNames:[]
    }

    /**
     * 过滤提示大设备名称
     */
    handleSearch = (value:string) => {
        const dictionaryEquiptment=DictionaryLoader.instance.equipment();
        let resultArray:Array<string>=[];
        dictionaryEquiptment.map((dict:DictionaryData)=>{
            if(dict.label&&(String(dict.label).indexOf(value)!==-1)){
                resultArray.push(String(dict.label));
            }
        });
        this.setState({
            equiptmentNames:resultArray
        });
    };

    render(){
        const {Option}=Select;
        const {equiptmentNames}=this.state;

        return (
            <Form layout="inline" labelCol={{span:0}} wrapperCol={{span:24}}>
                <ul className="form-ul-group">
                    <li>
                        <Col span={4}>
                           <Form.Item>
                               <Select defaultValue="1">
                                   <Option value="1">大型设备</Option>
                                   <Option value="2">普通设备</Option>
                               </Select>
                           </Form.Item>
                        </Col>
                        <Col span={1}><span className="divider">--</span></Col>
                        <Col span={8}>
                           <Form.Item>
                               <AutoComplete 
                                    dataSource={equiptmentNames}
                                    onSearch={this.handleSearch}
                                    placeholder="请输入设备名称"
                               />
                           </Form.Item>
                        </Col>
                        <Col span={1}><span className="divider">--</span></Col>
                        <Col span={4}>
                           <Form.Item>
                               <InputNumber min={1} step={0} defaultValue={1} 
                                   formatter={value => `${value}台`}
                                   parser={value => value?value.replace('台', ''):""}
                               />
                           </Form.Item>
                        </Col>
                        <Col span={4}>
                           <Icon
                               className="dynamic-delete-button"
                               type="minus-circle-o"
                           />
                        </Col>
                    </li>
                    <li>
                        <Col span={18}>
                            <Form.Item>
                               <Button type="dashed">
                                   <Icon type="plus" /> 添加设备
                               </Button>
                            </Form.Item>
                        </Col>
                    </li>
                </ul>
            </Form>
        );
    }
}