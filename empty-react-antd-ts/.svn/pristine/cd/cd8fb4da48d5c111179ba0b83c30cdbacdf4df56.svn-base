{"ast":null,"code":"import \"antd/es/spin/style/css\";\nimport _Spin from \"antd/es/spin\";\nimport _objectSpread from \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport \"antd/es/notification/style/css\";\nimport _notification from \"antd/es/notification\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/config-provider/style/css\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/dropdown/style/css\";\nimport _Dropdown from \"antd/es/dropdown\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/avatar/style/css\";\nimport _Avatar from \"antd/es/avatar\";\nimport \"antd/es/menu/style/css\";\nimport _Menu from \"antd/es/menu\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/layout/style/css\";\nimport _Layout from \"antd/es/layout\";\nvar _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/components/Container.tsx\";\nimport './Container.css';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport zhCN from 'antd/es/locale/zh_CN';\nimport ImageViewer from './ImageViewer';\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\nimport { LoginChecker } from '../app/LoginChecker';\nimport { HttpRequest } from '../app/Request';\nimport { DataCache } from '../app/DataCache';\nmoment.locale('zh-cn');\n\n/**\n * 公共组件：顶部栏，包括logo、菜单和登录状态判断；\n */\nclass ContainerWithHeader extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {};\n    this.loginChecker = new LoginChecker();\n\n    this.logout = async () => {\n      // 请求服务\n      await new HttpRequest().get(\"web/audit/user/logout\"); // 清除本地缓存\n\n      DataCache.instance.tokenClear(); // 跳转到登录页\n\n      this.props.history.replace(\"/\");\n    };\n  }\n\n  /**\n   * 通用布局容器\n   */\n  render() {\n    const Header = _Layout.Header,\n          Content = _Layout.Content,\n          Footer = _Layout.Footer;\n    const loginStatus = this.state.loginStatus;\n    const isLogin = loginStatus ? loginStatus.isLogin : false;\n    const menu = React.createElement(_Menu, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    }, React.createElement(_Menu.Item, {\n      onClick: this.logout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"logout\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }), \" \\u9000\\u51FA\"));\n    return React.createElement(_ConfigProvider, {\n      locale: zhCN,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(_Layout, {\n      className: \"layout\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header-logo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, process.env.REACT_APP_NAME), isLogin ? React.createElement(_Dropdown, {\n      overlay: menu,\n      placement: \"bottomLeft\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      className: \"header-login-button\",\n      type: \"link\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, React.createElement(_Avatar, {\n      icon: \"user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }), \" \\u673A\\u6784\\u540D\\u79F0\")) : React.createElement(_Button, {\n      className: \"header-login-button\",\n      type: \"link\",\n      onClick: this.logout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(_Avatar, {\n      icon: \"user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }), \" \\u673A\\u6784\\u767B\\u5F55\"), isLogin ? React.createElement(_Menu, {\n      theme: \"dark\",\n      mode: \"horizontal\",\n      style: {\n        lineHeight: '64px'\n      },\n      selectedKeys: [this.props.selectKey],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(_Menu.Item, {\n      key: \"organization\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, \"\\u9996\\u9875\"), React.createElement(_Menu.SubMenu, {\n      title: \"\\u53D8\\u66F4\\u7533\\u8BF7\",\n      key: \"apply\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(_Menu.Item, {\n      key: \"apply:nameChange\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, \"\\u540D\\u79F0\\u53D8\\u66F4\"))) : null)), React.createElement(Content, {\n      className: \"content-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, this.props.children), React.createElement(Footer, {\n      className: \"footer-container\",\n      style: {\n        textAlign: \"center\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, \"copyright@\\u6210\\u90FD\\u91D1\\u63A7\\u6570\\u636E\\u670D\\u52A1\\u6709\\u9650\\u516C\\u53F8.System Version\\uFF1A\".concat(process.env.REACT_APP_VERSION)), React.createElement(ImageViewer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    })));\n  }\n  /**\n   * 载入全部后，设置消息提示样式\n   */\n\n\n  async componentDidMount() {\n    _message.config({\n      maxCount: 3\n    });\n\n    _notification.config({\n      placement: \"bottomRight\",\n      duration: 0\n    });\n\n    const loginStatus = await this.loginChecker.loginUser(); // 未登录并且必须登录，返回登录页面\n\n    if (!loginStatus.isLogin && this.props.needLogin) {\n      this.props.history.replace(\"/\");\n      return;\n    }\n\n    this.setState(_objectSpread({}, this.state, {\n      loginStatus: loginStatus\n    }));\n  }\n  /**\n   * 顶部退出登录处理：请求服务后，清除本地缓存，跳转到登录页\n   */\n\n\n}\n\nconst Container = withRouter(ContainerWithHeader);\nexport default Container;\n/**\n * 载入中\n */\n\nexport class ContainerLoading extends React.Component {\n  render() {\n    return React.createElement(Container, {\n      needLogin: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(_Spin, {\n      className: \"page-loading\",\n      size: \"large\",\n      tip: \"\\u6B63\\u5728\\u8F7D\\u5165\\u2026\\u2026\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/components/Container.tsx"],"names":["React","withRouter","zhCN","ImageViewer","moment","LoginChecker","HttpRequest","DataCache","locale","ContainerWithHeader","Component","state","loginChecker","logout","get","instance","tokenClear","props","history","replace","render","Header","Content","Footer","loginStatus","isLogin","menu","process","env","REACT_APP_NAME","lineHeight","selectKey","children","textAlign","REACT_APP_VERSION","componentDidMount","config","maxCount","placement","duration","loginUser","needLogin","setState","Container","ContainerLoading"],"mappings":"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","sourcesContent":["import './Container.css';\n\nimport React from 'react';\nimport {withRouter, RouteComponentProps} from 'react-router-dom';\nimport { Layout, Menu, Button, Avatar, Dropdown, Icon,message, notification, Spin, ConfigProvider } from 'antd';\nimport zhCN from 'antd/es/locale/zh_CN';\nimport ImageViewer from './ImageViewer';\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\nimport { LoginStatus } from '../app/Model';\nimport { LoginChecker } from '../app/LoginChecker';\nimport { HttpRequest } from '../app/Request';\nimport { DataCache } from '../app/DataCache';\nmoment.locale('zh-cn');\n\ntype ContainerWithHeaderProps=RouteComponentProps&{\n    /**当前页面是否必须登录 */\n    needLogin:boolean;\n    /**选中顶部菜单 */\n    selectKey?:string;\n}\n\n/**\n * 公共组件：顶部栏，包括logo、菜单和登录状态判断；\n */\nclass ContainerWithHeader extends React.Component<ContainerWithHeaderProps>{\n    readonly state:{\n        /**当前的登录情况 */\n        loginStatus?:LoginStatus;\n    }={\n        \n    }\n\n    /**\n     * 登录检查器\n     */\n    private loginChecker=new LoginChecker();\n\n    /**\n     * 通用布局容器\n     */\n    render(){\n        const {Header,Content,Footer}=Layout;\n        const {loginStatus}=this.state;\n        const isLogin=loginStatus?loginStatus.isLogin:false;\n        const menu=(\n            <Menu>\n                <Menu.Item onClick={this.logout}>\n                    <Icon type=\"logout\"/> 退出\n                </Menu.Item>\n            </Menu>\n        );\n\n        return (\n            <ConfigProvider locale={zhCN}>\n                <Layout className=\"layout\">\n                    <Header>\n                        <div className=\"header-container\">\n                            <div className=\"header-logo\">{process.env.REACT_APP_NAME}</div>\n                            {isLogin?(\n                                    <Dropdown overlay={menu} placement=\"bottomLeft\">\n                                        <Button className=\"header-login-button\" type=\"link\">\n                                            <Avatar icon=\"user\"/> 机构名称\n                                        </Button>\n                                    </Dropdown>\n                                ):(\n                                    <Button\n                                        className=\"header-login-button\"\n                                        type=\"link\" onClick={this.logout}>\n                                        <Avatar icon=\"user\"/> 机构登录\n                                    </Button>\n                                )\n                            }\n                            {isLogin?(\n                                    <Menu theme=\"dark\" mode=\"horizontal\" \n                                        style={{lineHeight:'64px'}}\n                                        selectedKeys={[this.props.selectKey]}\n                                        >\n                                        <Menu.Item key=\"organization\">首页</Menu.Item>\n                                        <Menu.SubMenu title=\"变更申请\" key=\"apply\">\n                                            <Menu.Item key=\"apply:nameChange\">名称变更</Menu.Item>\n                                        </Menu.SubMenu>\n                                    </Menu>\n                                ):null\n                            }\n                        </div>\n                    </Header>\n                    <Content className=\"content-container\">\n                        {this.props.children}\n                    </Content>\n                    <Footer className=\"footer-container\" style={{textAlign:\"center\"}}>\n                        {`copyright@成都金控数据服务有限公司.System Version：${process.env.REACT_APP_VERSION}`}\n                    </Footer>\n\n                    {/* 图片查看器 */}\n                    <ImageViewer />\n                </Layout>\n            </ConfigProvider>\n        );\n    }\n\n    /**\n     * 载入全部后，设置消息提示样式\n     */\n    async componentDidMount(){\n        message.config({\n            maxCount:3\n        });\n        notification.config({\n            placement:\"bottomRight\",\n            duration:0\n        });\n\n        const loginStatus=await this.loginChecker.loginUser();\n        // 未登录并且必须登录，返回登录页面\n        if(!loginStatus.isLogin&&this.props.needLogin){\n            this.props.history.replace(\"/\");\n            return;\n        }\n        this.setState({\n            ...this.state,\n            loginStatus:loginStatus\n        })\n    }\n\n    /**\n     * 顶部退出登录处理：请求服务后，清除本地缓存，跳转到登录页\n     */\n    logout=async ()=>{\n        // 请求服务\n        await (new HttpRequest()).get<any>(\"web/audit/user/logout\");\n        // 清除本地缓存\n        DataCache.instance.tokenClear();\n        // 跳转到登录页\n        this.props.history.replace(\"/\");\n    };\n}\nconst Container=withRouter(ContainerWithHeader);\nexport default Container;\n\n/**\n * 载入中\n */\nexport class ContainerLoading extends React.Component{\n    render(){\n        return (\n            <Container needLogin={false}>\n                <Spin className=\"page-loading\" size=\"large\" tip=\"正在载入……\"></Spin>\n            </Container>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}