{"ast":null,"code":"import \"antd/es/notification/style/css\";\nimport _notification from \"antd/es/notification\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/alert/style/css\";\nimport _Alert from \"antd/es/alert\";\nimport \"antd/es/col/style/css\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/divider/style/css\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/breadcrumb/style/css\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/typography/style/css\";\nimport _Typography from \"antd/es/typography\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport _objectSpread from \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/pages/public/RecordStaff.tsx\";\nimport React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { ApplySectionPrompt, ApplySectionRecordStep } from '../../components/ApplyHeader';\nimport ApplyFormLegal from '../../components/ApplyFormLegal';\nimport ApplyFormPrincipal from '../../components/ApplyFormPrincipal';\nimport ApplyFormContact from '../../components/ApplyFormContact';\nimport { withRouter } from 'react-router-dom';\nimport StaffManager from '../../components/StaffManager';\nimport { ApplyStep, PageError500 } from '../../app/Model';\nimport { HttpRequest } from '../../app/Request';\nimport ApplyUtils from '../../utils/ApplyUtils';\nimport InteractionUtils from '../../utils/InteractionUtils';\n/**\n * 备案流程：第三步，人员信息\n */\n\nclass RecordStaff extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      serialNumber: this.props.match.params.id,\n      loading: false,\n      submiting: false,\n      saved: true,\n      hasFileValidateError: false,\n      alert: {\n        show: false,\n        title: \"\",\n        description: \"\"\n      }\n    };\n    this.legalFormRef = React.createRef();\n    this.principalFormRef = React.createRef();\n    this.contactFormRef = React.createRef();\n    this.staffManagerRef = React.createRef();\n\n    this.personInforChangeHandler = () => {\n      this.setState(_objectSpread({}, this.state, {\n        saved: false\n      }));\n    };\n\n    this.prevStep = () => {\n      const toPrevStep = () => {\n        InteractionUtils.scrollToTop();\n        this.props.history.push(ApplyStep.RECORD_ORGANIZATION.routePath(this.state.serialNumber));\n      };\n\n      if (!this.state.saved) {\n        _Modal.confirm({\n          title: \"确定要离开这里么?\",\n          content: \"未保存的信息将会丢失！\",\n          okText: \"继续离开\",\n          cancelText: \"取消\",\n\n          onOk() {\n            toPrevStep();\n          }\n\n        });\n\n        return;\n      }\n\n      toPrevStep();\n    };\n\n    this.generateSaveStaff = async () => {\n      // 验证法人输入内容\n      const legal = await this.legalFormRef.validateFieldsAndScroll();\n\n      if (legal.hasError && legal.message !== \"\") {\n        _message.error(legal.message);\n\n        return null;\n      } // 验证负责人输入内容\n\n\n      const principal = await this.principalFormRef.validateFieldsAndScroll();\n\n      if (principal.hasError && principal.message !== \"\") {\n        _message.error(principal.message);\n\n        return null;\n      } // 验证联系人输入内容\n\n\n      const contact = await this.contactFormRef.validateFieldsAndScroll();\n\n      if (contact.hasError && contact.message !== \"\") {\n        _message.error(contact.message);\n\n        return null;\n      } // 构建保存的内容\n\n\n      return _objectSpread({\n        applyNo: this.state.serialNumber,\n        applyManagers: [legal, principal, contact]\n      }, this.staffManagerRef.staffs());\n    };\n\n    this.saveStaffButNotSubmit = async () => {\n      const savedData = await this.generateSaveStaff();\n      if (!savedData) return; // 发起保存请求\n\n      this.setState(_objectSpread({}, this.state, {\n        loading: true\n      }));\n      const saveResponse = await new HttpRequest().post(\"webapi/apply/savePersonInfo\", savedData); //请求失败显示错误信息\n\n      if (!saveResponse.success) {\n        this.setState(_objectSpread({}, this.state, {\n          loading: false,\n          alert: {\n            show: true,\n            title: \"保存失败\",\n            description: saveResponse.message\n          }\n        }));\n      }\n\n      this.setState(_objectSpread({}, this.state, {\n        loading: false,\n        saved: true,\n        alert: _objectSpread({}, this.state.alert, {\n          show: false\n        })\n      }));\n\n      _message.success(\"保存成功！\");\n    };\n\n    this.saveStaffAndSubmit = async () => {\n      const savedData = await this.generateSaveStaff();\n      if (!savedData) return;\n      const setState = this.setState,\n            state = this.state,\n            props = this.props;\n\n      _Modal.confirm({\n        title: \"确定要提交执业申请么?\",\n        content: \"提交后申请内容将无法修改！\",\n        okText: \"继续提交\",\n        cancelText: \"取消\",\n\n        async onOk() {\n          // 发起保存请求\n          setState(_objectSpread({}, state, {\n            submiting: true\n          }));\n          const saveResponse = await new HttpRequest().post(\"webapi/apply/submitApply\", savedData); //请求失败显示错误信息\n\n          if (!saveResponse.success) {\n            setState(_objectSpread({}, state, {\n              submiting: false,\n              alert: {\n                show: true,\n                title: \"提交失败\",\n                description: saveResponse.message\n              }\n            }));\n          } //成功后转入下一步\n\n\n          setState(_objectSpread({}, state, {\n            submiting: false\n          }));\n          InteractionUtils.scrollToTop();\n          props.history.push(ApplyStep.RECORD_RESULT.routePath(state.serialNumber));\n        }\n\n      });\n    };\n  }\n\n  /**\n   * 页面布局\n   */\n  render() {\n    //未载入数据时\n    if (!this.state.apply || !this.state.legal || !this.state.principal || !this.state.contact) {\n      return React.createElement(ContainerLoading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      });\n    }\n\n    const Title = _Typography.Title;\n    const recordApply = {\n      applyNo: \"337676\",\n      applyDeadline: \"2019年1月1日\"\n    };\n    return React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb, {\n      className: \"breadcrumb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"file-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"\\u6267\\u4E1A\\u7533\\u8BF7\")), React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"\\u5907\\u6848\"))), React.createElement(Title, {\n      level: 4,\n      className: \"title-with-underline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, \"\\u5907\\u6848\\u7533\\u8BF7\"), React.createElement(ApplySectionPrompt, {\n      serialNumber: this.state.serialNumber,\n      deadline: this.state.apply.effectiveDate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), React.createElement(ApplySectionRecordStep, Object.assign({}, ApplyStep.RECORD_STAFF, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    })), React.createElement(_Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"title-inner\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, \"\\u7B2C\\u4E09\\u6B65\\uFF1A\\u4EBA\\u5458\\u4FE1\\u606F\")), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"\\u6CD5\\u4EBA\\u4FE1\\u606F\"), React.createElement(ApplyFormLegal, {\n      wrappedComponentRef: ref => this.legalFormRef = ref,\n      serialNumber: this.state.serialNumber,\n      manager: this.state.legal,\n      disabled: this.state.loading || this.state.submiting,\n      onChange: this.personInforChangeHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"\\u8D1F\\u8D23\\u4EBA\\u4FE1\\u606F\"), React.createElement(ApplyFormPrincipal, {\n      wrappedComponentRef: ref => this.principalFormRef = ref,\n      serialNumber: this.state.serialNumber,\n      manager: this.state.principal,\n      disabled: this.state.loading || this.state.submiting,\n      onChange: this.personInforChangeHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"\\u8054\\u7CFB\\u4EBA\\u4FE1\\u606F\"), React.createElement(ApplyFormContact, {\n      wrappedComponentRef: ref => this.contactFormRef = ref,\n      serialNumber: this.state.serialNumber,\n      manager: this.state.contact,\n      disabled: this.state.loading || this.state.submiting,\n      onChange: this.personInforChangeHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, \"\\u5176\\u4ED6\\u4EBA\\u5458\"), React.createElement(StaffManager, {\n      wrappedComponentRef: ref => this.staffManagerRef = ref,\n      serialNumber: this.state.serialNumber,\n      disabled: this.state.loading || this.state.submiting,\n      onChange: this.personInforChangeHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    })), this.state.alert.show ? React.createElement(_Col, {\n      span: 12,\n      offset: 6,\n      style: {\n        marginTop: 10\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(_Alert, {\n      message: this.state.alert.title,\n      description: this.state.alert.description,\n      type: \"error\",\n      showIcon: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    })) : null, React.createElement(_Col, {\n      span: 24,\n      className: \"section-buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      onClick: this.prevStep,\n      disabled: this.state.loading || this.state.submiting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"\\u4E0A\\u4E00\\u6B65\"), React.createElement(_Button, {\n      type: \"primary\",\n      onClick: this.saveStaffButNotSubmit,\n      loading: this.state.loading,\n      disabled: this.state.submiting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"\\u4FDD\\u5B58\\u4F46\\u4E0D\\u63D0\\u4EA4\"), React.createElement(_Button, {\n      type: \"danger\",\n      onClick: this.saveStaffAndSubmit,\n      loading: this.state.submiting,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"\\u4FDD\\u5B58\\u5E76\\u63D0\\u4EA4\\u7533\\u8BF7\")));\n  }\n  /**\n   * 组件载入后，载入数据信息（包括申请单信息和管理人员信息）\n   */\n\n\n  async componentDidMount() {\n    //获取申请单信息\n    const applyExistResponse = await new HttpRequest().get(\"webapi/apply/existApplyNo?applyNo=\".concat(this.state.serialNumber)); // 失败跳转500\n\n    if (!applyExistResponse.success || !applyExistResponse.data) {\n      this.props.history.push(PageError500);\n      return;\n    } // 不可编辑跳转审核结果\n\n\n    const commit = applyExistResponse.data.commit;\n\n    if (commit) {\n      this.props.history.push(ApplyStep.RECORD_RESULT.routePath(this.state.serialNumber));\n      return;\n    } // 获取管理人员信息\n\n\n    const applyManagerResponse = await new HttpRequest().get(\"webapi/apply/managerPersonInfo?applyNo=\".concat(this.state.serialNumber)); // 失败跳转500\n\n    if (!applyManagerResponse.success || !applyManagerResponse.data) {\n      this.props.history.push(PageError500);\n      return;\n    } // 遍历拆分管理人员为法人、负责人和联系人\n\n\n    const _ApplyUtils$managerLi = ApplyUtils.managerListToMap(this.state.serialNumber, applyManagerResponse.data),\n          legal = _ApplyUtils$managerLi.legal,\n          principal = _ApplyUtils$managerLi.principal,\n          contact = _ApplyUtils$managerLi.contact; // 设置显示\n\n\n    this.setState(_objectSpread({}, this.state, {\n      apply: _objectSpread({}, applyExistResponse.data),\n      legal: legal,\n      principal: principal,\n      contact: contact\n    })); // 添加窗口关闭监听\n\n    InteractionUtils.addWindowCloseListener(event => {\n      if (this.state.saved) event.preventDefault();else event.returnValue = true;\n    }); // 审核被驳回，获取驳回理由\n\n    if (ApplyUtils.needLoadReject(applyExistResponse.data.status)) {\n      const rejectArrayResponse = await new HttpRequest().get(\"webapi/apply/auditOpinion?applyNo=\".concat(this.state.serialNumber)); // 失败\n\n      if (!rejectArrayResponse.success || !rejectArrayResponse.data) {\n        return;\n      } // 找到最新的拒绝内容\n\n\n      let rejectContent = null;\n\n      for (let l = rejectArrayResponse.data.length, i = l - 1; i > -1; i--) {\n        const current = rejectArrayResponse.data[i];\n\n        if (ApplyUtils.inspectIsReject(current.status)) {\n          rejectContent = current;\n          break;\n        }\n      } //通知显示拒绝理由\n\n\n      if (!rejectContent) return;\n\n      _notification[\"warning\"]({\n        message: \"申请被驳回！\",\n        description: rejectContent.opinion\n      });\n    }\n  }\n  /**\n   * 卸载时删除窗口关闭监听\n   */\n\n\n  componentWillUnmount() {\n    InteractionUtils.removeWindowCloseListener();\n  }\n  /**\n   * 信息修改处理\n   */\n\n\n}\n\nexport default withRouter(RecordStaff);","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/pages/public/RecordStaff.tsx"],"names":["React","Container","ContainerLoading","ApplySectionPrompt","ApplySectionRecordStep","ApplyFormLegal","ApplyFormPrincipal","ApplyFormContact","withRouter","StaffManager","ApplyStep","PageError500","HttpRequest","ApplyUtils","InteractionUtils","RecordStaff","Component","state","serialNumber","props","match","params","id","loading","submiting","saved","hasFileValidateError","alert","show","title","description","legalFormRef","createRef","principalFormRef","contactFormRef","staffManagerRef","personInforChangeHandler","setState","prevStep","toPrevStep","scrollToTop","history","push","RECORD_ORGANIZATION","routePath","confirm","content","okText","cancelText","onOk","generateSaveStaff","legal","validateFieldsAndScroll","hasError","message","error","principal","contact","applyNo","applyManagers","staffs","saveStaffButNotSubmit","savedData","saveResponse","post","success","saveStaffAndSubmit","RECORD_RESULT","render","apply","Title","recordApply","applyDeadline","effectiveDate","RECORD_STAFF","ref","marginTop","componentDidMount","applyExistResponse","get","data","commit","applyManagerResponse","managerListToMap","addWindowCloseListener","event","preventDefault","returnValue","needLoadReject","status","rejectArrayResponse","rejectContent","l","length","i","current","inspectIsReject","opinion","componentWillUnmount","removeWindowCloseListener"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { Breadcrumb,Icon,Typography, Button, Divider, Col, Modal, notification, message, Alert } from 'antd';\nimport { ApplySectionPrompt, ApplySectionRecordStep } from '../../components/ApplyHeader';\nimport ApplyFormLegal from '../../components/ApplyFormLegal';\nimport ApplyFormPrincipal from '../../components/ApplyFormPrincipal';\nimport ApplyFormContact from '../../components/ApplyFormContact';\nimport { withRouter } from 'react-router-dom';\nimport StaffManager from '../../components/StaffManager';\nimport { ApplyContent, ApplyStep, AppComponentProps, ApplyContentManager, ApplyContentExist, PageError500, ApplyInspectContent, FormValidateResult } from '../../app/Model';\nimport { HttpRequest, HttpResponse } from '../../app/Request';\nimport ApplyUtils from '../../utils/ApplyUtils';\nimport InteractionUtils from '../../utils/InteractionUtils';\n\n/**\n * 备案流程：第三步，人员信息\n */\nclass RecordStaff extends React.Component<AppComponentProps>{\n    readonly state:{\n        /**申请单号 */\n        serialNumber:string;\n        /**保存按钮是否请求中 */\n        loading:boolean;\n        /**提交按钮是否请求中 */\n        submiting:boolean;\n        /**是否已经保存 */\n        saved:boolean;\n        /**文件上传验证错误 */\n        hasFileValidateError:boolean;\n        /**申请单基本信息 */\n        apply?:ApplyContentExist,\n        /**法人信息 */\n        legal?:ApplyContentManager,\n        /**负责人信息 */\n        principal?:ApplyContentManager,\n        /**联系人信息 */\n        contact?:ApplyContentManager,\n        /**弹出信息提示 */\n        alert:{\n            show:boolean,\n            title:string,\n            description:string\n        }\n    }={\n        serialNumber:this.props.match.params.id,\n        loading:false,\n        submiting:false,\n        saved:true,\n        hasFileValidateError:false,\n        alert:{show:false,title:\"\",description:\"\"}\n    };\n\n    private legalFormRef:any=React.createRef();\n    private principalFormRef:any=React.createRef();\n    private contactFormRef:any=React.createRef();\n    private staffManagerRef:any=React.createRef();\n\n    /**\n     * 页面布局\n     */\n    render(){\n        //未载入数据时\n        if(!this.state.apply||!this.state.legal\n            ||!this.state.principal||!this.state.contact){\n            return (\n                <ContainerLoading />\n            );\n        }\n\n        const {Title}=Typography;\n        const recordApply:ApplyContent={applyNo:\"337676\",applyDeadline:\"2019年1月1日\"};\n\n        return (\n            <Container>\n                {/* 标题 */}\n                <Breadcrumb className=\"breadcrumb\">\n                    <Breadcrumb.Item><Icon type=\"file-text\"/><span>执业申请</span></Breadcrumb.Item>\n                    <Breadcrumb.Item><span>备案</span></Breadcrumb.Item>\n                </Breadcrumb>\n                <Title level={4} className=\"title-with-underline\">备案申请</Title>\n\n                {/* 顶部 */}\n                <ApplySectionPrompt serialNumber={this.state.serialNumber} \n                    deadline={this.state.apply.effectiveDate} />\n                <ApplySectionRecordStep {...ApplyStep.RECORD_STAFF} />\n                <Divider><span className=\"title-inner\">第三步：人员信息</span></Divider>\n\n                {/* 表单：法人信息 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">法人信息</h4>\n                    <ApplyFormLegal wrappedComponentRef={(ref:any)=>this.legalFormRef=ref}\n                        serialNumber={this.state.serialNumber}\n                        manager={this.state.legal} \n                        disabled={this.state.loading||this.state.submiting}\n                        onChange={this.personInforChangeHandler}\n                    />\n                </Col>\n\n                {/* 表单：负责人信息 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">负责人信息</h4>\n                    <ApplyFormPrincipal wrappedComponentRef={(ref:any)=>this.principalFormRef=ref}\n                        serialNumber={this.state.serialNumber}\n                        manager={this.state.principal} \n                        disabled={this.state.loading||this.state.submiting}\n                        onChange={this.personInforChangeHandler}\n                    />\n                </Col>\n\n                {/* 表单：联系人信息 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">联系人信息</h4>\n                    <ApplyFormContact wrappedComponentRef={(ref:any)=>this.contactFormRef=ref}\n                        serialNumber={this.state.serialNumber}\n                        manager={this.state.contact} \n                        disabled={this.state.loading||this.state.submiting}\n                        onChange={this.personInforChangeHandler}\n                    />\n                </Col>\n\n                {/* 表单：人员管理 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">其他人员</h4>\n                    <StaffManager wrappedComponentRef={(ref:any)=>this.staffManagerRef=ref}\n                        serialNumber={this.state.serialNumber} \n                        disabled={this.state.loading||this.state.submiting}\n                        onChange={this.personInforChangeHandler}\n                    />\n                </Col>\n\n                {/* 提示信息 */}\n                {(this.state.alert.show)?(\n                    <Col span={12} offset={6} style={{marginTop:10}}>\n                        <Alert\n                            message={this.state.alert.title}\n                            description={this.state.alert.description}\n                            type=\"error\" showIcon\n                        />\n                    </Col>\n                ):null}\n\n                {/* 按钮 */}\n                <Col span={24} className=\"section-buttons\">\n                    <Button \n                        onClick={this.prevStep}\n                        disabled={this.state.loading||this.state.submiting}\n                    >\n                        上一步\n                    </Button>\n                    <Button type=\"primary\"\n                        onClick={this.saveStaffButNotSubmit}\n                        loading={this.state.loading}\n                        disabled={this.state.submiting}\n                    >\n                        保存但不提交\n                    </Button>\n                    <Button type=\"danger\" \n                        onClick={this.saveStaffAndSubmit}\n                        loading={this.state.submiting}\n                        disabled={this.state.loading}\n                    >\n                        保存并提交申请\n                    </Button>\n                </Col>\n            </Container>\n        );\n    }\n\n    /**\n     * 组件载入后，载入数据信息（包括申请单信息和管理人员信息）\n     */\n    async componentDidMount(){\n        //获取申请单信息\n        const applyExistResponse:HttpResponse<ApplyContentExist>=\n            await ((new HttpRequest()).get<ApplyContentExist>(\n                `webapi/apply/existApplyNo?applyNo=${this.state.serialNumber}`\n            ));\n\n        // 失败跳转500\n        if(!applyExistResponse.success||!applyExistResponse.data){\n            this.props.history.push(PageError500);\n            return;\n        }\n\n        // 不可编辑跳转审核结果\n        const {commit}=applyExistResponse.data;\n        if(commit){\n            this.props.history.push(ApplyStep.RECORD_RESULT.routePath(this.state.serialNumber));\n            return;\n        }\n\n        // 获取管理人员信息\n        const applyManagerResponse:HttpResponse<Array<ApplyContentManager>>=\n            await ((new HttpRequest()).get<Array<ApplyContentManager>>(\n                `webapi/apply/managerPersonInfo?applyNo=${this.state.serialNumber}`\n            ));\n        // 失败跳转500\n        if(!applyManagerResponse.success||!applyManagerResponse.data){\n            this.props.history.push(PageError500);\n            return;\n        }\n\n        // 遍历拆分管理人员为法人、负责人和联系人\n        const {legal,principal,contact}=ApplyUtils.managerListToMap(\n            this.state.serialNumber,applyManagerResponse.data\n        );\n        // 设置显示\n        this.setState({\n            ...this.state,\n            apply:{\n                ...applyExistResponse.data\n            },\n            legal:legal,\n            principal:principal,\n            contact:contact\n        });\n\n        // 添加窗口关闭监听\n        InteractionUtils.addWindowCloseListener((event:Event)=>{\n            if(this.state.saved)    event.preventDefault();\n            else                    event.returnValue=true;\n        });\n\n        // 审核被驳回，获取驳回理由\n        if(ApplyUtils.needLoadReject(applyExistResponse.data.status)){\n            const rejectArrayResponse:HttpResponse<Array<ApplyInspectContent>>=\n            await ((new HttpRequest()).get<Array<ApplyInspectContent>>(\n                `webapi/apply/auditOpinion?applyNo=${this.state.serialNumber}`\n            ));\n\n            // 失败\n            if(!rejectArrayResponse.success||!rejectArrayResponse.data){\n                return;\n            }\n\n            // 找到最新的拒绝内容\n            let rejectContent:ApplyInspectContent|null=null;\n            for(let l=rejectArrayResponse.data.length,i=l-1;i>-1;i--){\n                const current=rejectArrayResponse.data[i];\n                if(ApplyUtils.inspectIsReject(current.status)){\n                    rejectContent=current;\n                    break;\n                }\n            }\n\n            //通知显示拒绝理由\n            if(!rejectContent) return;\n            notification[\"warning\"]({\n                message:\"申请被驳回！\",\n                description:rejectContent.opinion\n            });\n        }\n    }\n\n    /**\n     * 卸载时删除窗口关闭监听\n     */\n    componentWillUnmount(){\n        InteractionUtils.removeWindowCloseListener();\n    }\n\n    /**\n     * 信息修改处理\n     */\n    personInforChangeHandler=()=>{\n        this.setState({\n            ...this.state,\n            saved:false\n        });\n    };\n\n    /**\n     * 上一步\n     */\n    prevStep=()=>{\n        const toPrevStep=()=>{\n            InteractionUtils.scrollToTop();\n            this.props.history.push(ApplyStep.RECORD_ORGANIZATION.routePath(this.state.serialNumber));\n        };\n\n        if(!this.state.saved){\n            Modal.confirm({\n                title: \"确定要离开这里么?\",\n                content:\"未保存的信息将会丢失！\",\n                okText:\"继续离开\",\n                cancelText:\"取消\",\n                onOk() {toPrevStep()},\n            });\n            return;\n        }\n        \n        toPrevStep();\n    }\n\n    /**\n     * 生成人员保存的内容\n     */\n    generateSaveStaff=async ()=>{\n        // 验证法人输入内容\n        const legal:FormValidateResult<ApplyContentManager>=\n            await this.legalFormRef.validateFieldsAndScroll();\n        if(legal.hasError&&legal.message!==\"\"){\n            message.error(legal.message);\n            return null;\n        }\n\n        // 验证负责人输入内容\n        const principal:FormValidateResult<ApplyContentManager>=\n            await this.principalFormRef.validateFieldsAndScroll();\n        if(principal.hasError&&principal.message!==\"\"){\n            message.error(principal.message);\n            return null;\n        }\n\n        // 验证联系人输入内容\n        const contact:FormValidateResult<ApplyContentManager>=\n            await this.contactFormRef.validateFieldsAndScroll();\n        if(contact.hasError&&contact.message!==\"\"){\n            message.error(contact.message);\n            return null;\n        }\n\n        // 构建保存的内容\n        return {\n            applyNo:this.state.serialNumber,\n            applyManagers:[legal,principal,contact],\n            ...this.staffManagerRef.staffs()\n        }\n    }\n\n    /**\n     * 保存但不提交\n     */\n    saveStaffButNotSubmit=async ()=>{\n        const savedData=await this.generateSaveStaff();\n        if(!savedData) return;\n        \n        // 发起保存请求\n        this.setState({...this.state,loading:true});\n        const saveResponse:HttpResponse<any>=\n            await ((new HttpRequest()).post<any,object>(\n                \"webapi/apply/savePersonInfo\",\n                savedData\n            ));\n\n        //请求失败显示错误信息\n        if(!saveResponse.success){\n            this.setState({\n                ...this.state,\n                loading:false,\n                alert:{\n                    show:true,\n                    title:\"保存失败\",\n                    description:saveResponse.message\n                }\n            });\n        }\n\n        this.setState({\n            ...this.state,\n            loading:false,\n            saved:true,\n            alert:{\n                ...this.state.alert,\n                show:false\n            }\n        });\n        message.success(\"保存成功！\");\n    }\n\n    /**\n     * 保存并提交\n     */\n    saveStaffAndSubmit=async ()=>{\n        const savedData=await this.generateSaveStaff();\n        if(!savedData) return;\n        const {setState,state,props}=this;\n\n        Modal.confirm({\n            title: \"确定要提交执业申请么?\",\n            content:\"提交后申请内容将无法修改！\",\n            okText:\"继续提交\",\n            cancelText:\"取消\",\n            async onOk() {\n                // 发起保存请求\n                setState({...state,submiting:true});\n                const saveResponse:HttpResponse<any>=\n                    await ((new HttpRequest()).post<any,object>(\n                        \"webapi/apply/submitApply\",\n                        savedData\n                    ));\n\n                //请求失败显示错误信息\n                if(!saveResponse.success){\n                    setState({\n                        ...state,\n                        submiting:false,\n                        alert:{\n                            show:true,\n                            title:\"提交失败\",\n                            description:saveResponse.message\n                        }\n                    });\n                }\n\n                //成功后转入下一步\n                setState({...state,submiting:false});\n                InteractionUtils.scrollToTop();\n                props.history.push(ApplyStep.RECORD_RESULT.routePath(state.serialNumber));\n            },\n        });\n    }\n}\nexport default withRouter(RecordStaff);"]},"metadata":{},"sourceType":"module"}