{"ast":null,"code":"var _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/components/ImageViewer.tsx\";\nimport 'photoswipe/dist/photoswipe.css';\nimport 'photoswipe/dist/default-skin/default-skin.css';\nimport React from 'react';\nimport PhotoSwipe from 'photoswipe';\nimport PhotoSwipeUI_Default from 'photoswipe/dist/photoswipe-ui-default';\n/**\n * 全屏图片查看器（基于PhotoSwipe）\n */\n\nclass ImageViewer extends React.Component {\n  /**\n   * 当前的查看器HTML元素\n   */\n\n  /**\n   * 查看指定的图片内容\n   * @param items 图片数组\n   * @param selectedIndex 进入后默认选择的图片索引\n   */\n  static view(items, selectedIndex) {\n    if (ImageViewer.pswp) {\n      // 生成图片数组\n      const images = [];\n      items.map(img => {\n        let sizeString = img.getAttribute(\"data-size\");\n        sizeString = sizeString ? sizeString.indexOf(\"x\") !== -1 ? sizeString : null : sizeString;\n        const sizeArray = sizeString ? sizeString.split(\"x\") : [String(img.naturalWidth), String(img.naturalHeight)];\n        images.push({\n          src: img.src,\n          w: Number(sizeArray[0]),\n          h: Number(sizeArray[1]),\n          title: img.getAttribute(\"title\") || img.getAttribute(\"alt\") || \"\"\n        });\n      }); //构建图片查看器对象\n\n      const photoSwipe = new PhotoSwipe(ImageViewer.pswp, PhotoSwipeUI_Default, images, {\n        closeOnScroll: false,\n        index: selectedIndex,\n\n        getThumbBoundsFn(index) {\n          const img = items[index];\n          const pageYScroll = window.pageYOffset || document.documentElement.scrollTop;\n          const rect = img.getBoundingClientRect();\n          return {\n            x: rect.left,\n            y: rect.top + pageYScroll,\n            w: rect.width\n          };\n        }\n\n      }); //自动识别data-size\n\n      photoSwipe.listen(\"imageLoadComplete\", (index, Item) => {\n        const img = items[index];\n        const sizeString = img.getAttribute(\"data-size\");\n\n        if (!sizeString || sizeString.indexOf(\"x\") === -1) {\n          const image = new Image();\n          image.src = img.src;\n        }\n      });\n      photoSwipe.init();\n    }\n  }\n  /**\n   * 布局内容\n   */\n\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"pswp\",\n      tabIndex: -1,\n      role: \"dialog\",\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__bg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"pswp__scroll-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"pswp__item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"pswp__item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"pswp__ui pswp__ui--hidden\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__top-bar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__counter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"pswp__button pswp__button--close\",\n      title: \"Close (Esc)\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"pswp__button pswp__button--share\",\n      title: \"Share\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"pswp__button pswp__button--fs\",\n      title: \"Toggle fullscreen\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"pswp__button pswp__button--zoom\",\n      title: \"Zoom in/out\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"pswp__preloader\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__preloader__icn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__preloader__cut\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__preloader__donut\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }))))), React.createElement(\"div\", {\n      className: \"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__share-tooltip\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      className: \"pswp__button pswp__button--arrow--left\",\n      title: \"Previous (arrow left)\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"pswp__button pswp__button--arrow--right\",\n      title: \"Next (arrow right)\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"pswp__caption\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pswp__caption__center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    })))));\n  }\n  /**\n   * 载入后记录当前的查看器元素\n   */\n\n\n  componentDidMount() {\n    const pswp = document.querySelector(\".pswp\");\n    if (!pswp) return;\n    ImageViewer.pswp = pswp;\n  }\n\n}\n\nImageViewer.pswp = void 0;\nexport default ImageViewer;","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/components/ImageViewer.tsx"],"names":["React","PhotoSwipe","PhotoSwipeUI_Default","ImageViewer","Component","view","items","selectedIndex","pswp","images","map","img","sizeString","getAttribute","indexOf","sizeArray","split","String","naturalWidth","naturalHeight","push","src","w","Number","h","title","photoSwipe","closeOnScroll","index","getThumbBoundsFn","pageYScroll","window","pageYOffset","document","documentElement","scrollTop","rect","getBoundingClientRect","x","left","y","top","width","listen","Item","image","Image","init","render","componentDidMount","querySelector"],"mappings":"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","sourcesContent":["import 'photoswipe/dist/photoswipe.css'\nimport 'photoswipe/dist/default-skin/default-skin.css'\n\nimport React from 'react';\nimport PhotoSwipe from 'photoswipe';\nimport PhotoSwipeUI_Default, { Item } from 'photoswipe/dist/photoswipe-ui-default'; \n\n/**\n * 全屏图片查看器（基于PhotoSwipe）\n */\nclass ImageViewer extends React.Component{\n    /**\n     * 当前的查看器HTML元素\n     */\n    private static pswp:HTMLElement;\n\n    /**\n     * 查看指定的图片内容\n     * @param items 图片数组\n     * @param selectedIndex 进入后默认选择的图片索引\n     */\n    static view(items:Array<HTMLImageElement>,selectedIndex:number){\n        if(ImageViewer.pswp){\n            // 生成图片数组\n            const images:Array<Item>=[];\n            items.map(img=>{\n                let sizeString=img.getAttribute(\"data-size\");\n                sizeString=(sizeString\n                    ?(sizeString.indexOf(\"x\")!==-1?sizeString:null)\n                    :sizeString\n                );\n                const sizeArray=(sizeString\n                    ?sizeString.split(\"x\")\n                    :[String(img.naturalWidth),String(img.naturalHeight)]\n                );\n                images.push({\n                    src:img.src,\n                    w:Number(sizeArray[0]),\n                    h:Number(sizeArray[1]),\n                    title:img.getAttribute(\"title\")||img.getAttribute(\"alt\")||\"\"\n                });\n            });\n\n            //构建图片查看器对象\n            const photoSwipe=new PhotoSwipe(\n                ImageViewer.pswp,\n                PhotoSwipeUI_Default,\n                images,\n                {\n                    closeOnScroll:false,\n                    index:selectedIndex,\n                    getThumbBoundsFn(index){\n                        const img=items[index];\n                        const pageYScroll = window.pageYOffset || document.documentElement.scrollTop;\n                        const rect = img.getBoundingClientRect();\n                        return {x:rect.left, y:rect.top + pageYScroll, w:rect.width};\n                    }\n                }\n            );\n            //自动识别data-size\n            photoSwipe.listen(\"imageLoadComplete\",(index,Item)=>{\n                const img=items[index];\n                const sizeString=img.getAttribute(\"data-size\");\n                if(!sizeString||sizeString.indexOf(\"x\")===-1){\n                    const image=new Image();\n                    image.src=img.src;\n                    \n                }\n            });\n            photoSwipe.init();\n        }\n    }\n\n    /**\n     * 布局内容\n     */\n    render(){\n        return (\n            <div className=\"pswp\" tabIndex={-1} role=\"dialog\" aria-hidden=\"true\">\n                <div className=\"pswp__bg\"></div>\n                <div className=\"pswp__scroll-wrap\">\n                    <div className=\"pswp__container\">\n                        <div className=\"pswp__item\"></div>\n                        <div className=\"pswp__item\"></div>\n                        <div className=\"pswp__item\"></div>\n                    </div>\n                    <div className=\"pswp__ui pswp__ui--hidden\">\n                        <div className=\"pswp__top-bar\">\n                            <div className=\"pswp__counter\"></div>\n                            <button className=\"pswp__button pswp__button--close\" title=\"Close (Esc)\"></button>\n                            <button className=\"pswp__button pswp__button--share\" title=\"Share\"></button>\n                            <button className=\"pswp__button pswp__button--fs\" title=\"Toggle fullscreen\"></button>\n                            <button className=\"pswp__button pswp__button--zoom\" title=\"Zoom in/out\"></button>\n                            <div className=\"pswp__preloader\">\n                                <div className=\"pswp__preloader__icn\">\n                                <div className=\"pswp__preloader__cut\">\n                                    <div className=\"pswp__preloader__donut\"></div>\n                                </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div className=\"pswp__share-modal pswp__share-modal--hidden pswp__single-tap\">\n                            <div className=\"pswp__share-tooltip\"></div> \n                        </div>\n                        <button className=\"pswp__button pswp__button--arrow--left\" title=\"Previous (arrow left)\">\n                        </button>\n                        <button className=\"pswp__button pswp__button--arrow--right\" title=\"Next (arrow right)\">\n                        </button>\n                        <div className=\"pswp__caption\">\n                            <div className=\"pswp__caption__center\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    /**\n     * 载入后记录当前的查看器元素\n     */\n    componentDidMount(){\n        const pswp=document.querySelector<HTMLElement>(\".pswp\");\n        if(!pswp) return;\n        ImageViewer.pswp=pswp;\n    }\n}\nexport default ImageViewer;"]},"metadata":{},"sourceType":"module"}