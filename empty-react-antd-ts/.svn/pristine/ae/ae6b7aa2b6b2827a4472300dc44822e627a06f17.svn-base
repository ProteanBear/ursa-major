{"ast":null,"code":"import \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/col/style/css\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/divider/style/css\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/breadcrumb/style/css\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/typography/style/css\";\nimport _Typography from \"antd/es/typography\";\nimport \"antd/es/notification/style/css\";\nimport _notification from \"antd/es/notification\";\nimport _objectSpread from \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/pages/public/RecordCommitment.tsx\";\nimport React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { withRouter, Link } from 'react-router-dom';\nimport { ApplySectionPrompt, ApplySectionRecordStep } from '../../components/ApplyHeader';\nimport ApplyFormCommitment from '../../components/ApplyFormCommitment';\nimport { ApplyStep, PageError500 } from '../../app/Model';\nimport { HttpRequest } from '../../app/Request';\nimport InteractionUtils from '../../utils/InteractionUtils';\nimport ApplyUtils from '../../utils/ApplyUtils';\n/**\n * 备案流程：第一步，承诺书\n */\n\nclass RecordCommitment extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      serialNumber: this.props.match.params.id,\n      loading: false\n      /**\n       * 页面布局\n       */\n\n    };\n\n    this.uploadCompleted = url => {\n      this.setState(_objectSpread({}, this.state, {\n        data: _objectSpread({}, this.state.data, {\n          commitment: url\n        })\n      })); // 上传完成后自动保存进入下一步\n\n      this.saveCommitmentAndNext();\n    };\n\n    this.onCommitmentRemove = () => {\n      this.setState(_objectSpread({}, this.state, {\n        data: _objectSpread({}, this.state.data, {\n          commitment: \"\"\n        })\n      }));\n    };\n\n    this.saveCommitmentAndNext = async () => {\n      if (!this.state.data) return;\n      this.setState(_objectSpread({}, this.state, {\n        loading: true\n      }));\n      const saveResponse = await new HttpRequest().post(\"webapi/apply/saveCommitment\", {\n        applyNo: this.state.serialNumber,\n        commitment: this.state.data.commitment\n      });\n\n      if (!saveResponse.success) {\n        this.props.history.push(PageError500);\n      }\n\n      this.setState(_objectSpread({}, this.state, {\n        loading: false\n      }));\n\n      _notification.destroy();\n\n      InteractionUtils.scrollToTop();\n      this.props.history.push(ApplyStep.RECORD_ORGANIZATION.routePath(this.state.serialNumber));\n    };\n  }\n\n  render() {\n    const Title = _Typography.Title; //未载入数据时\n\n    if (!this.state.data) {\n      return React.createElement(ContainerLoading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37\n        },\n        __self: this\n      });\n    } //载入数据成功后\n\n\n    return React.createElement(Container, {\n      needLogin: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb, {\n      className: \"breadcrumb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/public\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"file-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }), \"\\xA0\", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }, \"\\u6267\\u4E1A\\u7533\\u8BF7\"))), React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, \"\\u5907\\u6848\"))), React.createElement(Title, {\n      level: 4,\n      className: \"title-with-underline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, \"\\u5907\\u6848\\u7533\\u8BF7\"), React.createElement(ApplySectionPrompt, {\n      serialNumber: this.state.serialNumber,\n      deadline: this.state.data.effectiveTimeStr,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }), React.createElement(ApplySectionRecordStep, Object.assign({}, ApplyStep.RECORD_COMMITMENT, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    })), React.createElement(_Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"title-inner\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, \"\\u7B2C\\u4E00\\u6B65\\uFF1A\\u627F\\u8BFA\\u4E66\")), React.createElement(ApplyFormCommitment, {\n      serialNumber: this.state.serialNumber,\n      organization: this.state.data,\n      onUploadCompleted: this.uploadCompleted,\n      onRemove: this.onCommitmentRemove,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }), React.createElement(_Col, {\n      span: 24,\n      className: \"section-buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      type: \"primary\",\n      loading: this.state.loading,\n      disabled: \"\" === this.state.data.commitment,\n      onClick: this.saveCommitmentAndNext,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, \"\\u4FDD\\u5B58\\u5E76\\u8FDB\\u5165\\u4E0B\\u4E00\\u6B65\")));\n  }\n  /**\n   * 组件完成后请求获取申请信息\n   */\n\n\n  async componentDidMount() {\n    // 获取机构申请信息\n    const applyResponse = await new HttpRequest().get(\"webapi/apply/getRecordInfo?applyNo=\".concat(this.state.serialNumber)); // 失败跳转500\n\n    if (!applyResponse.success || !applyResponse.data) {\n      this.props.history.push(PageError500);\n      return;\n    } // 不可编辑跳转审核结果\n\n\n    const applyStatus = applyResponse.data.applyStatus;\n\n    if (!ApplyUtils.canEdit(applyStatus)) {\n      this.props.history.push(ApplyStep.RECORD_RESULT.routePath(this.state.serialNumber));\n      return;\n    } // 设置显示\n\n\n    this.setState(_objectSpread({}, this.state, {\n      data: applyResponse.data\n    })); // 审核被驳回，获取驳回理由\n\n    if (ApplyUtils.needLoadReject(applyStatus)) {\n      const rejectArrayResponse = await new HttpRequest().get(\"webapi/apply/auditOpinion?applyNo=\".concat(this.state.serialNumber)); // 失败\n\n      if (!rejectArrayResponse.success || !rejectArrayResponse.data) {\n        return;\n      } // 找到最新的拒绝内容\n\n\n      let rejectContent = null;\n\n      for (let l = rejectArrayResponse.data.length, i = l - 1; i > -1; i--) {\n        const current = rejectArrayResponse.data[i];\n\n        if (ApplyUtils.inspectIsReject(current.status)) {\n          rejectContent = current;\n          break;\n        }\n      } //通知显示拒绝理由\n\n\n      if (!rejectContent) return;\n\n      _notification[\"warning\"]({\n        message: \"申请被驳回！\",\n        description: rejectContent.opinion\n      });\n    }\n  }\n  /**\n   * 告知承诺书上传完成\n   */\n\n\n}\n\nexport default withRouter(_Form.create({\n  name: \"pageRecordCommitment\"\n})(RecordCommitment));","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/pages/public/RecordCommitment.tsx"],"names":["React","Container","ContainerLoading","withRouter","Link","ApplySectionPrompt","ApplySectionRecordStep","ApplyFormCommitment","ApplyStep","PageError500","HttpRequest","InteractionUtils","ApplyUtils","RecordCommitment","Component","state","serialNumber","props","match","params","id","loading","uploadCompleted","url","setState","data","commitment","saveCommitmentAndNext","onCommitmentRemove","saveResponse","post","applyNo","success","history","push","destroy","scrollToTop","RECORD_ORGANIZATION","routePath","render","Title","effectiveTimeStr","RECORD_COMMITMENT","componentDidMount","applyResponse","get","applyStatus","canEdit","RECORD_RESULT","needLoadReject","rejectArrayResponse","rejectContent","l","length","i","current","inspectIsReject","status","message","description","opinion","create","name"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { Breadcrumb,Icon,Typography, Button, Divider,Col,Form,notification} from 'antd';\nimport { withRouter, Link } from 'react-router-dom';\nimport { ApplySectionPrompt, ApplySectionRecordStep } from '../../components/ApplyHeader';\nimport ApplyFormCommitment  from '../../components/ApplyFormCommitment';\nimport { ApplyStep, AppComponentProps, ApplyContentOrganization, PageError500, ApplyInspectContent} from '../../app/Model';\nimport { HttpResponse, HttpRequest } from '../../app/Request';\nimport InteractionUtils from '../../utils/InteractionUtils';\nimport ApplyUtils from '../../utils/ApplyUtils';\n\n/**\n * 备案流程：第一步，承诺书\n */\nclass RecordCommitment extends React.Component<AppComponentProps>{\n    readonly state:{\n        /**申请单号 */\n        serialNumber:string;\n        /**保存按钮是否请求中 */\n        loading:boolean;\n        /**申请内容 */\n        data?:ApplyContentOrganization,\n    }={\n        serialNumber:this.props.match.params.id,\n        loading:false\n    }\n\n    /**\n     * 页面布局\n     */\n    render(){\n        const {Title}=Typography;\n\n        //未载入数据时\n        if(!this.state.data){\n            return (\n                <ContainerLoading />\n            );\n        }\n\n        //载入数据成功后\n        return (\n            <Container needLogin={false}>\n                {/* 标题 */}\n                <Breadcrumb className=\"breadcrumb\">\n                    <Breadcrumb.Item>\n                        <Link to=\"/public\">\n                            <Icon type=\"file-text\"/>&nbsp;\n                            <span>执业申请</span>\n                        </Link>\n                    </Breadcrumb.Item>\n                    <Breadcrumb.Item><span>备案</span></Breadcrumb.Item>\n                </Breadcrumb>\n                <Title level={4} className=\"title-with-underline\">备案申请</Title>\n\n                {/* 顶部 */}\n                <ApplySectionPrompt serialNumber={this.state.serialNumber} \n                    deadline={this.state.data.effectiveTimeStr} />\n                <ApplySectionRecordStep {...ApplyStep.RECORD_COMMITMENT} />\n                <Divider><span className=\"title-inner\">第一步：承诺书</span></Divider>\n\n                {/* 表单 */}\n                <ApplyFormCommitment \n                    serialNumber={this.state.serialNumber} \n                    organization={this.state.data} \n                    onUploadCompleted={this.uploadCompleted}\n                    onRemove={this.onCommitmentRemove}\n                />\n\n                {/* 按钮 */}\n                <Col span={24} className=\"section-buttons\">\n                    <Button type=\"primary\" \n                        loading={this.state.loading}\n                        disabled={\"\"===this.state.data.commitment}\n                        onClick={this.saveCommitmentAndNext}\n                        >\n                        保存并进入下一步\n                    </Button>\n                </Col>\n            </Container>\n        );\n    }\n\n    /**\n     * 组件完成后请求获取申请信息\n     */\n    async componentDidMount(){\n        // 获取机构申请信息\n        const applyResponse=\n            await ((new HttpRequest()).get<ApplyContentOrganization>(\n                `webapi/apply/getRecordInfo?applyNo=${this.state.serialNumber}`\n            ));\n\n        // 失败跳转500\n        if(!applyResponse.success||!applyResponse.data){\n            this.props.history.push(PageError500);\n            return;\n        }\n\n        // 不可编辑跳转审核结果\n        const {applyStatus}=applyResponse.data;\n        if(!ApplyUtils.canEdit(applyStatus)){\n            this.props.history.push(ApplyStep.RECORD_RESULT.routePath(this.state.serialNumber));\n            return;\n        }\n\n        // 设置显示\n        this.setState({\n            ...this.state,\n            data:applyResponse.data\n        });\n\n        // 审核被驳回，获取驳回理由\n        if(ApplyUtils.needLoadReject(applyStatus)){\n            const rejectArrayResponse:HttpResponse<Array<ApplyInspectContent>>=\n            await ((new HttpRequest()).get<Array<ApplyInspectContent>>(\n                `webapi/apply/auditOpinion?applyNo=${this.state.serialNumber}`\n            ));\n\n            // 失败\n            if(!rejectArrayResponse.success||!rejectArrayResponse.data){\n                return;\n            }\n\n            // 找到最新的拒绝内容\n            let rejectContent:ApplyInspectContent|null=null;\n            for(let l=rejectArrayResponse.data.length,i=l-1;i>-1;i--){\n                const current=rejectArrayResponse.data[i];\n                if(ApplyUtils.inspectIsReject(current.status)){\n                    rejectContent=current;\n                    break;\n                }\n            }\n\n            //通知显示拒绝理由\n            if(!rejectContent) return;\n            notification[\"warning\"]({\n                message:\"申请被驳回！\",\n                description:rejectContent.opinion\n            });\n        }\n    }\n\n    /**\n     * 告知承诺书上传完成\n     */\n    uploadCompleted=(url:string)=>{\n        this.setState({\n            ...this.state,\n            data:{\n                ...this.state.data,\n                commitment:url\n            }\n        });\n\n        // 上传完成后自动保存进入下一步\n        this.saveCommitmentAndNext();\n    }\n\n    /**\n     * 删除时处理\n     */\n    onCommitmentRemove=()=>{\n        this.setState({\n            ...this.state,\n            data:{\n                ...this.state.data,\n                commitment:\"\"\n            }\n        });\n    }\n\n    /**\n     * 保存后并进入下一步\n     */\n    saveCommitmentAndNext=async ()=>{\n        if(!this.state.data) return;\n        this.setState({...this.state,loading:true});\n\n        const saveResponse:HttpResponse<any>=\n            await ((new HttpRequest()).post<any,{applyNo:string,commitment:string}>(\n                \"webapi/apply/saveCommitment\",\n                {\n                    applyNo:this.state.serialNumber,\n                    commitment:this.state.data.commitment\n                }\n            ));\n\n        if(!saveResponse.success){\n            this.props.history.push(PageError500);\n        }\n\n        this.setState({...this.state,loading:false});\n        notification.destroy();\n        InteractionUtils.scrollToTop();\n        this.props.history.push(ApplyStep.RECORD_ORGANIZATION.routePath(this.state.serialNumber));\n    }\n}\nexport default withRouter((Form.create({name:\"pageRecordCommitment\"})(RecordCommitment) as any));"]},"metadata":{},"sourceType":"module"}