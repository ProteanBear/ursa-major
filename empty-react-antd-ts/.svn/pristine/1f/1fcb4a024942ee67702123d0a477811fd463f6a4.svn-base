import React from 'react';
import { Form, Row, Col, DatePicker, Icon, Input, AutoComplete, Button } from 'antd';
import { FormComponentProps } from 'antd/lib/form';
import { DictionaryData,DictionaryLoader } from '../app/DictionaryLoader';

/**
 * 申请表单：工作履历
 */
class ApplyFormResume extends React.Component<FormComponentProps>{
    state:{jobs:Array<string>}={
        jobs:[]
    }

    /**
     * 过滤提示职务信息
     */
    handleSearch = (value:string) => {
        const dictionaryJobs=DictionaryLoader.instance.job();
        let resultArray:Array<string>=[];
        dictionaryJobs.map((dict:DictionaryData)=>{
            if(dict.label&&(String(dict.label).indexOf(value)!==-1)){
                resultArray.push(String(dict.label));
            }
        });
        this.setState({
            jobs:resultArray
        });
    };

    render(){
        const {getFieldDecorator} = this.props.form;
        const {jobs}=this.state;

        return (
            <ul className="form-ul-group">
                <li>
                    <Col span={6}>
                        <Form.Item>{
                            getFieldDecorator("resume.range",{
                                rules:[
                                    {required:false}
                                ]
                            })(<DatePicker.RangePicker placeholder={["开始日期","结束日期"]} />)}
                        </Form.Item>
                    </Col>
                    <Col span={1}><span className="divider" style={{marginTop:4}}>--</span></Col>
                    <Col span={8}>
                        <Form.Item>{
                            getFieldDecorator("resume.work",{
                                rules:[
                                    {required:true}
                                ]
                            })(<Input placeholder="工作的机构名称"/>)}
                        </Form.Item>
                    </Col>
                    <Col span={1}><span className="divider" style={{marginTop:4}}>--</span></Col>
                    <Col span={4}>
                        <Form.Item>
                            <AutoComplete 
                                dataSource={jobs}
                                onSearch={this.handleSearch}
                                placeholder="工作职务"
                            />
                        </Form.Item>
                    </Col>
                    <Col span={4}>
                        <Icon
                            className="dynamic-delete-button"
                            type="minus-circle-o"
                            style={{paddingTop:5}}
                        />
                    </Col>
                </li>
                <li>
                    <Col span={20}>
                        <Form.Item>
                            <Button type="dashed">
                                <Icon type="plus" /> 添加工作经历
                            </Button>
                        </Form.Item>
                    </Col>
                </li>
            </ul>
        );
    }
}
export default Form.create({name:"applyFormResume"})(ApplyFormResume);