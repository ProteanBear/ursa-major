import './Container.css';

import React from 'react';
import {NavLink, Link, withRouter, RouteComponentProps} from 'react-router-dom';
import { Layout, Menu, Button, Avatar, Dropdown, Icon } from 'antd';
import { LoginChecker } from '../app/LoginChecker';

/**
 * 公共组件：顶部栏，包括logo、菜单和登录状态判断；
 */
class ContainerWithHeader extends React.Component<RouteComponentProps>{
    logout=()=>{
        LoginChecker.isLogin=false;
        this.props.history.replace("/");
    };

    render(){
        const {Header,Content,Footer}=Layout;
        const selectedKey="switch";
        const isLogin=LoginChecker.isLogin;
        const menu=(
            <Menu>
                <Menu.Item onClick={this.logout}>
                    <Icon type="logout"/> 退出
                </Menu.Item>
            </Menu>
        );

        return (
            <Layout className="layout">
                <Header>
                    <div className="header-container">
                        <div className="header-logo">{process.env.REACT_APP_NAME}</div>
                        {isLogin?(
                                <Dropdown overlay={menu} placement="bottomLeft">
                                    <Button className="header-login-button" type="link">
                                        <Avatar icon="user"/> 机构名称
                                    </Button>
                                </Dropdown>
                            ):(
                                <Button className="header-login-button"
                                    type="link"
                                >
                                    <Link to="/"><Avatar icon="user"/> 机构登录</Link>
                                </Button>
                            )
                        }
                        {isLogin?(
                            <Menu theme="dark" mode="horizontal" 
                                defaultSelectedKeys={[selectedKey]}
                                style={{lineHeight:'64px'}}
                                >
                                <Menu.Item key="switch">信息维护</Menu.Item>
                            </Menu>
                        ):(
                            <Menu theme="dark" mode="horizontal" 
                                defaultSelectedKeys={[selectedKey]}
                                style={{lineHeight:'64px'}}
                                >
                            <Menu.Item key="switch">执业申请</Menu.Item>
                        </Menu>
                        )
                        }
                    </div>
                </Header>
                <Content className="content-container">
                    {this.props.children}
                </Content>
                <Footer className="footer-container"></Footer>
            </Layout>
        );
    }
}
export default withRouter(ContainerWithHeader);