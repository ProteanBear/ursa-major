{"ast":null,"code":"import \"antd/es/row/style/css\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/statistic/style/css\";\nimport _Statistic from \"antd/es/statistic\";\nimport \"antd/es/col/style/css\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/descriptions/style/css\";\nimport _Descriptions from \"antd/es/descriptions\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/breadcrumb/style/css\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/tabs/style/css\";\nimport _Tabs from \"antd/es/tabs\";\nimport _objectSpread from \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/pages/protected/Organization.tsx\";\nimport React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { PageError500 } from '../../app/Model';\nimport { HttpRequest } from '../../app/Request';\nimport { withRouter } from 'react-router';\nimport ApplyDetailInforOrganization from '../../components/ApplyDetailInforOrganization';\nimport ApplyDetailInforManager from '../../components/ApplyDetailInforManager';\nimport ApplyDetailInforDoctorAndNurse from '../../components/ApplyDetailInforDoctorAndNurse';\nimport ApplyDetailInforStaffTech from '../../components/ApplyDetailInforStaffTech';\nimport ApplyDetailInforStaffOther from '../../components/ApplyDetailInforStaffOther';\nimport ApplyUtils from '../../utils/ApplyUtils';\n/**\n * 机构信息维护首页\n */\n\nclass Organization extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      apiUrl: {\n        doctors: \"web/org/staffList\",\n        techs: \"web/org/technicianList\",\n        others: \"web/org/otherList\"\n      },\n      data: {\n        doctors: [],\n        techs: [],\n        others: []\n      },\n      loading: {\n        doctors: true,\n        techs: true,\n        others: true\n      },\n      loadError: {\n        doctors: false,\n        techs: false,\n        others: false\n      },\n      page: {\n        doctors: {\n          index: 1,\n          size: 10\n        },\n        techs: {\n          index: 1,\n          size: 10\n        },\n        others: {\n          index: 1,\n          size: 10\n        }\n      }\n      /**\n       * 页面布局\n       */\n\n    };\n\n    this.onPageChange = (key, toPage) => {\n      toPage = toPage || this.state.page[key].index;\n      this.loadData(key, {\n        index: toPage,\n        size: this.state.page[key].size\n      });\n    };\n\n    this.loadData = async (key, toPage) => {\n      // 设置请求状态\n      const _this$state = this.state,\n            loading = _this$state.loading,\n            loadError = _this$state.loadError,\n            apiUrl = _this$state.apiUrl,\n            data = _this$state.data,\n            page = _this$state.page;\n      loading[key] = true;\n      loadError[key] = false;\n      this.setState(_objectSpread({}, this.state, {\n        loading: loading,\n        loadedError: loadError\n      })); // 发送请求\n\n      const listResponse = await new HttpRequest().get(apiUrl[key], toPage); // 错误返回\n\n      if (!listResponse.success || !listResponse.data) {\n        loading[key] = false;\n        loadError[key] = true;\n        this.setState(_objectSpread({}, this.state, {\n          loading: loading,\n          loadError: loadError\n        }));\n        return;\n      } // 记录列表\n\n\n      loading[key] = false;\n      loadError[key] = false;\n      data[key] = listResponse.data;\n      page[key] = listResponse.pageConfig || page[key];\n      this.setState(_objectSpread({}, this.state, {\n        loading: loading,\n        loadError: loadError,\n        data: data,\n        page: page\n      }));\n    };\n\n    this.downloadCert = () => {\n      const organization = this.state.organization;\n      if (!organization || !organization.eCert) return;\n      window.open(organization.eCert);\n    };\n  }\n\n  render() {\n    if (!this.state.organization || !this.state.legal || !this.state.princpal || !this.state.contact) {\n      return React.createElement(ContainerLoading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      });\n    }\n\n    const TabPane = _Tabs.TabPane;\n    const _this$state2 = this.state,\n          organization = _this$state2.organization,\n          legal = _this$state2.legal,\n          princpal = _this$state2.princpal,\n          contact = _this$state2.contact;\n    return React.createElement(Container, {\n      needLogin: true,\n      selectKey: \"organization\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb, {\n      className: \"breadcrumb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"home\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"\\u9996\\u9875\"))), React.createElement(_Row, {\n      className: \"content-container content-container-des\",\n      style: {\n        marginTop: 0,\n        minHeight: 0,\n        marginBottom: 0,\n        width: \"100%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(_Col, {\n      span: 16,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(_Descriptions, {\n      title: organization.name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(_Descriptions.Item, {\n      label: \"\\u767B\\u8BB0\\u7F16\\u53F7\",\n      span: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, organization.eCertNo, React.createElement(_Button, {\n      type: \"link\",\n      icon: \"download\",\n      size: \"small\",\n      onClick: this.downloadCert,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, \"\\u4E0B\\u8F7D\\u7535\\u5B50\\u8BC1\")), React.createElement(_Descriptions.Item, {\n      label: \"\\u8BC1\\u4E66\\u6709\\u6548\\u671F\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, ApplyUtils.displayDate(organization.effictiveStartTime)), React.createElement(_Descriptions.Item, {\n      label: \"\\u4E0B\\u4E2A\\u6821\\u9A8C\\u65E5\",\n      span: 2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, ApplyUtils.displayDate(organization.nextValidDate)), React.createElement(_Descriptions.Item, {\n      label: \"\\u8054\\u7CFB\\u7535\\u8BDD\",\n      span: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, contact.phone), React.createElement(_Descriptions.Item, {\n      span: 3,\n      label: \"\\u673A\\u6784\\u5730\\u5740\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, organization.address))), React.createElement(_Col, {\n      span: 8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"statistic-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(_Statistic, {\n      title: \"\\u533B\\u62A4\\u4EBA\\u5458\",\n      value: this.state.page.doctors.total,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }), React.createElement(_Statistic, {\n      title: \"\\u533B\\u6280\\u4EBA\\u5458\",\n      value: this.state.page.techs.total,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(_Statistic, {\n      title: \"\\u5176\\u4ED6\\u4EBA\\u5458\",\n      value: this.state.page.others.total,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    })))), React.createElement(_Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(_Tabs, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(TabPane, {\n      tab: \"\\u673A\\u6784\\u8BE6\\u60C5\",\n      key: \"organization\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(ApplyDetailInforOrganization, {\n      data: this.state.organization,\n      equipments: this.state.equipments,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    })), React.createElement(TabPane, {\n      tab: \"\\u7BA1\\u7406\\u4EBA\\u5458\",\n      key: \"manager\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(ApplyDetailInforManager, {\n      legal: this.state.legal,\n      princpal: this.state.princpal,\n      contact: this.state.contact,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    })), React.createElement(TabPane, {\n      tab: \"\\u533B\\u62A4\\u4EBA\\u5458\",\n      key: \"doctorsAndNurse\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(ApplyDetailInforDoctorAndNurse, {\n      data: this.state.data.doctors,\n      page: this.state.page.doctors,\n      loading: this.state.loading.doctors,\n      loadedError: this.state.loadError.doctors,\n      onPageChange: this.onPageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    })), React.createElement(TabPane, {\n      tab: \"\\u533B\\u6280\\u4EBA\\u5458\",\n      key: \"staffTechs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(ApplyDetailInforStaffTech, {\n      data: this.state.data.techs,\n      page: this.state.page.techs,\n      loading: this.state.loading.techs,\n      loadedError: this.state.loadError.techs,\n      onPageChange: this.onPageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    })), React.createElement(TabPane, {\n      tab: \"\\u5176\\u4ED6\\u4EBA\\u5458\",\n      key: \"staffOthers\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(ApplyDetailInforStaffOther, {\n      data: this.state.data.others,\n      page: this.state.page.others,\n      loading: this.state.loading.others,\n      loadedError: this.state.loadError.others,\n      onPageChange: this.onPageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }))))));\n  }\n  /**\n   * 页面载入后，载入机构信息\n   */\n\n\n  async componentDidMount() {\n    // 请求\n    const detailResponse = await new HttpRequest().get(\"web/org/orgInfo\"); // 获取失败，跳转500\n\n    if (!detailResponse.success || !detailResponse.data) {\n      this.props.history.push(PageError500);\n      return;\n    } // 分解三个管理人员\n\n\n    let legal, princpal, contact;\n    const managerPerson = detailResponse.data.managerPerson;\n    managerPerson.forEach(person => {\n      switch (person.type) {\n        // 法人\n        case 1:\n          legal = person;\n          break;\n        // 负责人\n\n        case 2:\n          princpal = person;\n          break;\n        // 联系人\n\n        case 3:\n          contact = person;\n          break;\n\n        default:\n      }\n    }); // 设置内容\n\n    this.setState(_objectSpread({}, this.state, {\n      organization: detailResponse.data.orgInfo,\n      equipments: detailResponse.data.equipment,\n      legal: legal,\n      princpal: princpal,\n      contact: contact\n    })); // 载入医护人员\n\n    this.loadData(\"doctors\", this.state.page.doctors); // 载入医技人员\n\n    this.loadData(\"techs\", this.state.page.techs); // 载入其他人员\n\n    this.loadData(\"others\", this.state.page.others);\n  }\n  /**\n   * 换页处理\n   */\n\n\n}\n\nexport default withRouter(Organization);","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/pages/protected/Organization.tsx"],"names":["React","Container","ContainerLoading","PageError500","HttpRequest","withRouter","ApplyDetailInforOrganization","ApplyDetailInforManager","ApplyDetailInforDoctorAndNurse","ApplyDetailInforStaffTech","ApplyDetailInforStaffOther","ApplyUtils","Organization","Component","state","apiUrl","doctors","techs","others","data","loading","loadError","page","index","size","onPageChange","key","toPage","loadData","setState","loadedError","listResponse","get","success","pageConfig","downloadCert","organization","eCert","window","open","render","legal","princpal","contact","TabPane","marginTop","minHeight","marginBottom","width","name","eCertNo","displayDate","effictiveStartTime","nextValidDate","phone","address","total","equipments","componentDidMount","detailResponse","props","history","push","managerPerson","forEach","person","type","orgInfo","equipment"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { Breadcrumb, Icon, Row, Col, Descriptions, Statistic, Tabs, Button } from 'antd';\nimport { ApplyContentOrganization, ApplyContentManager, PageError500, ApplyContentEquipment, ApplyDetailGroup } from '../../app/Model';\nimport { HttpRequest, PageConfig } from '../../app/Request';\nimport { RouteComponentProps, withRouter } from 'react-router';\nimport ApplyDetailInforOrganization from '../../components/ApplyDetailInforOrganization';\nimport ApplyDetailInforManager from '../../components/ApplyDetailInforManager';\nimport ApplyDetailInforDoctorAndNurse from '../../components/ApplyDetailInforDoctorAndNurse';\nimport ApplyDetailInforStaffTech from '../../components/ApplyDetailInforStaffTech';\nimport ApplyDetailInforStaffOther from '../../components/ApplyDetailInforStaffOther';\nimport ApplyUtils from '../../utils/ApplyUtils';\n\n/**\n * 机构信息维护首页\n */\nclass Organization extends React.Component<RouteComponentProps>{\n    readonly state:{\n        organization?:ApplyContentOrganization;\n        equipments?:Array<ApplyContentEquipment>\n        legal?:ApplyContentManager;\n        princpal?:ApplyContentManager;\n        contact?:ApplyContentManager;\n        apiUrl:{\n            [key:string]:any,\n        };\n        data:{\n            [key:string]:any,\n        };\n        loading:{\n            [key:string]:boolean,\n        };\n        loadError:{\n            [key:string]:boolean,\n        };\n        page:{\n            [key:string]:PageConfig\n        }\n    }={\n        apiUrl:{\n            doctors:\"web/org/staffList\",\n            techs:\"web/org/technicianList\",\n            others:\"web/org/otherList\"\n        },\n        data:{\n            doctors:[],\n            techs:[],\n            others:[]\n        },\n        loading:{\n            doctors:true,\n            techs:true,\n            others:true\n        },\n        loadError:{\n            doctors:false,\n            techs:false,\n            others:false\n        },\n        page:{\n            doctors:{index:1,size:10},\n            techs:{index:1,size:10},\n            others:{index:1,size:10}\n        },\n    }\n\n    /**\n     * 页面布局\n     */\n    render(){\n        if(!this.state.organization\n            ||!this.state.legal\n            ||!this.state.princpal\n            ||!this.state.contact){\n            return (<ContainerLoading />);\n        }\n\n        const {TabPane}=Tabs;\n        const {organization,legal,princpal,contact}=this.state;\n\n        return (\n            <Container needLogin={true} selectKey=\"organization\">\n                {/* 标题 */}\n                <Breadcrumb className=\"breadcrumb\">\n                    <Breadcrumb.Item><Icon type=\"home\"/><span>首页</span></Breadcrumb.Item>\n                </Breadcrumb>\n                {/* 基本信息 */}\n                <Row className=\"content-container content-container-des\" style={{marginTop:0,minHeight:0,marginBottom:0,width:\"100%\"}}>\n                    <Col span={16}>\n                        <Descriptions title={organization.name}>\n                        <Descriptions.Item label=\"登记编号\" span={3}>\n                            {organization.eCertNo}\n                            <Button type=\"link\" icon=\"download\" size=\"small\" onClick={this.downloadCert}>下载电子证</Button>\n                        </Descriptions.Item>\n                            <Descriptions.Item label=\"证书有效期\">{ApplyUtils.displayDate(organization.effictiveStartTime)}</Descriptions.Item>\n                            <Descriptions.Item label=\"下个校验日\" span={2}>{ApplyUtils.displayDate(organization.nextValidDate)}</Descriptions.Item>\n                            <Descriptions.Item label=\"联系电话\" span={3}>{contact.phone}</Descriptions.Item>\n                            <Descriptions.Item span={3} label=\"机构地址\">{organization.address}</Descriptions.Item>\n                        </Descriptions>\n                    </Col>\n                    <Col span={8}>\n                        <div className=\"statistic-group\">\n                            <Statistic title=\"医护人员\" value={this.state.page.doctors.total} />\n                            <Statistic title=\"医技人员\" value={this.state.page.techs.total}/>\n                            <Statistic title=\"其他人员\" value={this.state.page.others.total}/>\n                        </div>\n                    </Col>\n                </Row>\n                <Row>\n                    <Col span={22} offset={1}>\n                        <Tabs>\n                            <TabPane tab=\"机构详情\" key=\"organization\">\n                                <ApplyDetailInforOrganization \n                                    data={this.state.organization}\n                                    equipments={this.state.equipments}\n                                />\n                            </TabPane>\n                            <TabPane tab=\"管理人员\" key=\"manager\">\n                                <ApplyDetailInforManager \n                                    legal={this.state.legal}\n                                    princpal={this.state.princpal}\n                                    contact={this.state.contact}\n                                />\n                            </TabPane>\n                            <TabPane tab=\"医护人员\" key=\"doctorsAndNurse\">\n                                <ApplyDetailInforDoctorAndNurse \n                                    data={this.state.data.doctors}\n                                    page={this.state.page.doctors}\n                                    loading={this.state.loading.doctors}\n                                    loadedError={this.state.loadError.doctors}\n                                    onPageChange={this.onPageChange}\n                                />\n                            </TabPane>\n                            <TabPane tab=\"医技人员\" key=\"staffTechs\">\n                                <ApplyDetailInforStaffTech \n                                    data={this.state.data.techs}\n                                    page={this.state.page.techs}\n                                    loading={this.state.loading.techs}\n                                    loadedError={this.state.loadError.techs}\n                                    onPageChange={this.onPageChange}\n                                />\n                            </TabPane>\n                            <TabPane tab=\"其他人员\" key=\"staffOthers\">\n                                <ApplyDetailInforStaffOther\n                                    data={this.state.data.others}\n                                    page={this.state.page.others}\n                                    loading={this.state.loading.others}\n                                    loadedError={this.state.loadError.others}\n                                    onPageChange={this.onPageChange}\n                                />\n                            </TabPane>\n                        </Tabs>\n                    </Col>\n                </Row>\n            </Container>\n        );\n    }\n\n    /**\n     * 页面载入后，载入机构信息\n     */\n    async componentDidMount(){\n        // 请求\n        const detailResponse=await ((new HttpRequest())\n            .get<ApplyDetailGroup>(\"web/org/orgInfo\"));\n\n        // 获取失败，跳转500\n        if(!detailResponse.success||!detailResponse.data){\n            this.props.history.push(PageError500);\n            return;\n        }\n\n        // 分解三个管理人员\n        let legal,princpal,contact;\n        const {managerPerson}=detailResponse.data;\n        managerPerson.forEach(person=>{\n            switch(person.type){\n                // 法人\n                case 1:\n                    legal=person;\n                    break;\n                // 负责人\n                case 2:\n                    princpal=person;\n                    break;\n                // 联系人\n                case 3:\n                    contact=person;\n                    break;\n                default:\n            }\n        });\n\n        // 设置内容\n        this.setState({\n            ...this.state,\n            organization:detailResponse.data.orgInfo,\n            equipments:detailResponse.data.equipment,\n            legal:legal,\n            princpal:princpal,\n            contact:contact,\n        });\n\n        // 载入医护人员\n        this.loadData(\"doctors\",this.state.page.doctors);\n        // 载入医技人员\n        this.loadData(\"techs\",this.state.page.techs);\n        // 载入其他人员\n        this.loadData(\"others\",this.state.page.others);\n    }\n\n    /**\n     * 换页处理\n     */\n    onPageChange=(key:string,toPage?:number)=>{\n        toPage=toPage||this.state.page[key].index;\n        this.loadData(key,{index:toPage,size:this.state.page[key].size});\n    }\n\n    /**\n     * 载入数据\n     */\n    loadData=async (key:string,toPage:PageConfig)=>{\n        // 设置请求状态\n        const {loading,loadError,apiUrl,data,page}=this.state;\n        loading[key]=true;\n        loadError[key]=false;\n        this.setState({...this.state,loading:loading,loadedError:loadError});\n\n        // 发送请求\n        const listResponse=await ((new HttpRequest())\n            .get<Array<any>>(apiUrl[key],toPage));\n\n        // 错误返回\n        if(!listResponse.success||!listResponse.data){\n            loading[key]=false;\n            loadError[key]=true;\n            this.setState({\n                ...this.state,\n                loading:loading,\n                loadError:loadError,\n            });\n            return;\n        }\n\n        // 记录列表\n        loading[key]=false;\n        loadError[key]=false;\n        data[key]=listResponse.data;\n        page[key]=listResponse.pageConfig||page[key];\n        this.setState({\n            ...this.state,\n            loading:loading,\n            loadError:loadError,\n            data:data,\n            page:page\n        });\n    }\n\n    /**\n     * 下载电子证\n     */\n    downloadCert=()=>{\n        const {organization}=this.state;\n        if(!organization||!organization.eCert) return;\n        window.open(organization.eCert);\n    }\n}\nexport default withRouter(Organization);"]},"metadata":{},"sourceType":"module"}