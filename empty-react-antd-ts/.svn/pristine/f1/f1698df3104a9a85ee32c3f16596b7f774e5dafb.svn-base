{"ast":null,"code":"import \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/result/style/css\";\nimport _Result from \"antd/es/result\";\nimport \"antd/es/empty/style/css\";\nimport _Empty from \"antd/es/empty\";\nimport \"antd/es/col/style/css\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/tooltip/style/css\";\nimport _Tooltip from \"antd/es/tooltip\";\nimport \"antd/es/breadcrumb/style/css\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/card/style/css\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/typography/style/css\";\nimport _Typography from \"antd/es/typography\";\nvar _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/pages/public/Switch.tsx\";\nimport React from 'react';\nimport Container from '../../components/Container';\nimport { withRouter } from 'react-router-dom';\nimport { HttpRequest } from '../../app/Request';\nimport { ApplyType, ApplyStep } from '../../app/Model';\nimport { DataCache } from '../../app/DataCache';\n/**\n * 执业申请：业务选择页面\n */\n\nclass Switch extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      inputSerialNumber: \"\",\n      modalVisible: false,\n      modalErrorMessage: \"\",\n      loading: {\n        continueEdit: false,\n        applyRecord: false,\n        applyLicense: false\n      },\n      serialNumberExist: true\n      /**\n       * 页面布局\n       */\n\n    };\n\n    this.applyContinueEditOnChange = e => {\n      this.setState({\n        inputSerialNumber: e.target.value\n      });\n    };\n\n    this.applyContinueEditFromInputEnter = event => {\n      if (this.state.inputSerialNumber === \"\") {\n        this.setState({\n          serialNumberExist: true\n        });\n        return;\n      }\n\n      if (!event || event.key !== \"Enter\") return;\n      this.applyContinueEdit();\n    };\n\n    this.applyContinueEdit = async () => {\n      //请求中\n      this.setState({\n        loading: {\n          continueEdit: true\n        }\n      });\n      const serialNumber = this.state.inputSerialNumber;\n      const applyExist = await new HttpRequest().get(\"webapi/apply/existApplyNo?applyNo=\".concat(serialNumber)); //获取出错\n\n      if (!applyExist.success) {\n        this.setState({\n          modalVisible: true,\n          modalErrorMessage: applyExist.message,\n          loading: {\n            continueEdit: false\n          }\n        });\n      }\n\n      const exist = applyExist.data && applyExist.data.exist;\n      this.setState({\n        loading: {\n          continueEdit: false\n        },\n        serialNumberExist: exist\n      }); //存在，进入编辑页面\n\n      if (exist && applyExist.data) {\n        const applyType = ApplyType.create(applyExist.data.applyType);\n        const defaultRoute = applyType === ApplyType.RECORD ? ApplyStep.RECORD_COMMITMENT.routePath(serialNumber) : ApplyStep.LICENSE_COMMITMENT.routePath(serialNumber); //如果在审核中，进入结果页面\n\n        if (applyExist.data.commit) {\n          this.props.history.push(defaultRoute);\n        } //如果在编写中，进入编辑步骤页面\n        else {\n            const applyEditCached = DataCache.instance.edit(serialNumber);\n            this.props.history.push(applyEditCached ? applyEditCached.step.routePath(serialNumber) : defaultRoute);\n          }\n      }\n    };\n\n    this.viewImage = event => {\n      const img = event.target;\n    };\n\n    this.applyCreateRecord = async () => {\n      // 请求中\n      this.setState({\n        loading: {\n          applyRecord: true\n        }\n      }); //获取申请单号\n\n      try {\n        const _ref = await this.requestCreateApply(ApplyType.RECORD),\n              applyNo = _ref.applyNo;\n\n        this.props.history.push(\"/public/record/step-commitment/\".concat(applyNo));\n      } catch (error) {}\n    };\n\n    this.applyCreateLicense = async () => {\n      // 请求中\n      this.setState({\n        loading: {\n          applyLicense: true\n        }\n      }); //获取申请单号\n\n      try {\n        const _ref2 = await this.requestCreateApply(ApplyType.LICENSE),\n              applyNo = _ref2.applyNo;\n\n        this.props.history.push(\"/public/license/step-commitment/\".concat(applyNo));\n      } catch (error) {}\n    };\n\n    this.requestCreateApply = async type => {\n      const createdApply = await new HttpRequest().get(\"webapi/apply/applyNo?applyType=\".concat(type.key)); //创建失败\n\n      if (!createdApply.success) {\n        this.setState({\n          modalVisible: true,\n          modalErrorMessage: createdApply.message,\n          loading: {\n            continueEdit: false,\n            applyRecord: false,\n            applyLicense: false\n          }\n        });\n        throw new Error(createdApply.message);\n      }\n\n      return new Promise((resolve, reject) => resolve(createdApply.data));\n    };\n  }\n\n  render() {\n    const Title = _Typography.Title,\n          Paragraph = _Typography.Paragraph;\n    const Meta = _Card.Meta;\n    return React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb, {\n      className: \"breadcrumb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"file-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, \"\\u6267\\u4E1A\\u7533\\u8BF7\")), React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, \"\\u9009\\u62E9\\u529E\\u7406\\u4E1A\\u52A1\\u7C7B\\u578B\"))), React.createElement(Title, {\n      level: 4,\n      className: \"title-with-underline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, \"\\u7EE7\\u7EED\\u586B\\u5199\\u4E0A\\u6B21\\u7684\\u7533\\u8BF7\"), React.createElement(_Form, {\n      layout: \"inline\",\n      style: {\n        marginTop: 16\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, \"\\u7533\\u8BF7\\u5355\\u53F7\\xA0\", React.createElement(_Tooltip, {\n        title: \"\\u7533\\u8BF7\\u65F6\\u63D0\\u4F9B\\u7684\\u7533\\u8BF7\\u5355\\u53F7\\uFF01\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, React.createElement(_Icon, {\n        type: \"info-circle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }))),\n      hasFeedback: true,\n      validateStatus: this.state.loading.continueEdit ? \"validating\" : this.state.serialNumberExist ? \"\" : \"error\",\n      help: this.state.serialNumberExist ? \"\" : \"填写的申请单号不存在！\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\",\n      style: {\n        width: \"300px\"\n      },\n      value: this.state.inputSerialNumber,\n      onChange: this.applyContinueEditOnChange,\n      onKeyPress: this.applyContinueEditFromInputEnter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    })), React.createElement(_Form.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      type: \"primary\",\n      onClick: this.applyContinueEdit,\n      disabled: \"\" === this.state.inputSerialNumber,\n      loading: this.state.loading.continueEdit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, this.state.loading.continueEdit ? \"正在获取\" : \"继续填写\"))), React.createElement(Title, {\n      level: 4,\n      className: \"title-with-underline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"\\u6216\\u521B\\u5EFA\\u65B0\\u7684\\u7533\\u8BF7\"), React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(_Card, {\n      hoverable: true,\n      style: {\n        width: 300,\n        margin: \"10px auto\"\n      },\n      cover: React.createElement(\"img\", {\n        alt: \"example\",\n        src: \"https://os.alipayobjects.com/rmsportal/QBnOOoLaAfKPirc.png\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }),\n      actions: [React.createElement(_Button, {\n        type: \"primary\",\n        loading: this.state.loading.applyRecord,\n        onClick: this.applyCreateRecord,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, this.state.loading.applyRecord ? \"正在处理\" : \"申请备案\")],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(Meta, {\n      title: \"\\u5907\\u6848\",\n      description: \"\\u9002\\u5408\\u673A\\u6784\\uFF1A\\u8BCA\\u6240\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }))), React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(_Card, {\n      hoverable: true,\n      style: {\n        width: 300,\n        margin: \"10px auto\"\n      },\n      cover: React.createElement(_Empty, {\n        image: _Empty.PRESENTED_IMAGE_SIMPLE,\n        description: \"\\u6682\\u65E0\\u56FE\\u7247\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }),\n      actions: [React.createElement(_Button, {\n        type: \"primary\",\n        loading: this.state.loading.applyLicense,\n        onClick: this.applyCreateLicense,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, this.state.loading.applyLicense ? \"正在处理\" : \"申请许可\")],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(Meta, {\n      title: \"\\u8BB8\\u53EF\",\n      description: \"\\u9002\\u5408\\u673A\\u6784\\uFF1A\\u4E8C\\u7EA7\\u53CA\\u4E8C\\u7EA7\\u4EE5\\u4E0A\\u673A\\u6784\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }))), React.createElement(_Col, {\n      span: 10,\n      offset: 7,\n      className: \"section-prompt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Paragraph, {\n      ellipsis: {\n        rows: 3,\n        expandable: true\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"\\u8BF4\\u660E\"), \"\\uFF1A\\u63D0\\u793A\\u5185\\u5BB9\\u6682\\u65E0\\uFF01\")), React.createElement(_Modal, {\n      title: \"\",\n      visible: this.state.modalVisible,\n      footer: null,\n      onCancel: () => {\n        this.setState({\n          modalVisible: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(_Result, {\n      status: \"error\",\n      title: \"\\u64CD\\u4F5C\\u5931\\u8D25\",\n      subTitle: this.state.modalErrorMessage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    })));\n  }\n  /**\n   * 继续填写单号内容变化时，判断是否内容为空\n   */\n\n\n}\n\nexport default withRouter(_Form.create({\n  name: \"pageSwitch\"\n})(Switch));","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/pages/public/Switch.tsx"],"names":["React","Container","withRouter","HttpRequest","ApplyType","ApplyStep","DataCache","Switch","Component","state","inputSerialNumber","modalVisible","modalErrorMessage","loading","continueEdit","applyRecord","applyLicense","serialNumberExist","applyContinueEditOnChange","e","setState","target","value","applyContinueEditFromInputEnter","event","key","applyContinueEdit","serialNumber","applyExist","get","success","message","exist","data","applyType","create","defaultRoute","RECORD","RECORD_COMMITMENT","routePath","LICENSE_COMMITMENT","commit","props","history","push","applyEditCached","instance","edit","step","viewImage","img","applyCreateRecord","requestCreateApply","applyNo","error","applyCreateLicense","LICENSE","type","createdApply","Error","Promise","resolve","reject","render","Title","Paragraph","Meta","marginTop","width","margin","PRESENTED_IMAGE_SIMPLE","rows","expandable","name"],"mappings":"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","sourcesContent":["import React, {ChangeEvent, MouseEvent, KeyboardEvent } from 'react';\nimport Container from '../../components/Container';\nimport { Breadcrumb,Icon,Typography, Button, Form, Input,Tooltip,Card, Col, Empty, Modal, Result } from 'antd';\nimport { withRouter} from 'react-router-dom';\nimport { HttpResponse, HttpRequest } from '../../app/Request';\nimport { AppComponentProps, ApplyType, ApplyContent, ApplyStep} from '../../app/Model';\nimport { DataCache } from '../../app/DataCache';\n\n/**\n * 执业申请：业务选择页面\n */\nclass Switch extends React.Component<AppComponentProps>{\n    /**\n     * 状态设置：\n     * inputSerialNumber（填写的申请单号）\n     * modalVisible:错误提示框是否显示\n     */\n    readonly state:{\n        inputSerialNumber:string,\n        modalVisible:boolean,\n        modalErrorMessage:string,\n        loading:{\n            continueEdit:boolean,\n            applyRecord:boolean,\n            applyLicense:boolean\n        },\n        serialNumberExist:boolean\n    }={\n        inputSerialNumber:\"\",\n        modalVisible:false,\n        modalErrorMessage:\"\",\n        loading:{\n            continueEdit:false,\n            applyRecord:false,\n            applyLicense:false\n        },\n        serialNumberExist:true\n    }\n\n    /**\n     * 页面布局\n     */\n    render(){\n        const {Title,Paragraph}=Typography;\n        const {Meta}=Card;\n\n        return (\n            <Container>\n                <Breadcrumb className=\"breadcrumb\">\n                    <Breadcrumb.Item><Icon type=\"file-text\"/><span>执业申请</span></Breadcrumb.Item>\n                    <Breadcrumb.Item><span>选择办理业务类型</span></Breadcrumb.Item>\n                </Breadcrumb>\n\n                <Title level={4} className=\"title-with-underline\">继续填写上次的申请</Title>\n                <Form layout=\"inline\" style={{marginTop:16}}>\n                    <Form.Item \n                        label={\n                            <span>\n                                申请单号&nbsp;\n                                <Tooltip title=\"申请时提供的申请单号！\">\n                                    <Icon type=\"info-circle\" />\n                                </Tooltip>\n                            </span>\n                        }\n                        hasFeedback\n                        validateStatus={this.state.loading.continueEdit?\"validating\":(this.state.serialNumberExist?\"\":\"error\")}\n                        help={this.state.serialNumberExist?\"\":\"填写的申请单号不存在！\"}\n                    >\n                        <Input placeholder=\"请输入\" style={{width:\"300px\"}}\n                            value={this.state.inputSerialNumber}\n                            onChange={this.applyContinueEditOnChange}\n                            onKeyPress={this.applyContinueEditFromInputEnter}\n                        />\n                    </Form.Item>\n                    <Form.Item>\n                        <Button type=\"primary\" \n                            onClick={this.applyContinueEdit}\n                            disabled={\"\"===this.state.inputSerialNumber}\n                            loading={this.state.loading.continueEdit}\n                        >{this.state.loading.continueEdit?\"正在获取\":\"继续填写\"}</Button>\n                    </Form.Item>\n                </Form>\n                    \n                <Title level={4} className=\"title-with-underline\">或创建新的申请</Title>\n                <Col span={12}>\n                    <Card hoverable\n                        style={{ width: 300,margin:\"10px auto\"}}\n                        cover={<img alt=\"example\" src=\"https://os.alipayobjects.com/rmsportal/QBnOOoLaAfKPirc.png\" />}\n                        actions={[\n                            <Button type=\"primary\" \n                                loading={this.state.loading.applyRecord}\n                                onClick={this.applyCreateRecord}\n                            >{this.state.loading.applyRecord?\"正在处理\":\"申请备案\"}</Button>\n                        ]}\n                    >\n                        <Meta title=\"备案\" description=\"适合机构：诊所\" />\n                    </Card>\n                </Col>\n                <Col span={12}>\n                    <Card hoverable\n                        style={{ width: 300,margin:\"10px auto\"}}\n                        cover={<Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"暂无图片\" />}\n                        actions={[\n                            <Button type=\"primary\" \n                                loading={this.state.loading.applyLicense}\n                                onClick={this.applyCreateLicense}\n                            >{this.state.loading.applyLicense?\"正在处理\":\"申请许可\"}</Button>\n                        ]}\n                    >\n                        <Meta title=\"许可\" description=\"适合机构：二级及二级以上机构\" />\n                    </Card>\n                </Col>\n                <Col span={10} offset={7} className=\"section-prompt\">\n                    <Paragraph ellipsis={{ rows: 3, expandable: true }}>\n                        <b>说明</b>：提示内容暂无！\n                    </Paragraph>\n                </Col>\n\n                {/* 错误提示框 */}\n                <Modal\n                    title=\"\"\n                    visible={this.state.modalVisible}\n                    footer={null}\n                    onCancel={()=>{this.setState({modalVisible:false})}}\n                    >\n                    <Result\n                        status=\"error\"\n                        title=\"操作失败\"\n                        subTitle={this.state.modalErrorMessage}\n                    ></Result>\n                </Modal>\n            </Container>\n        );\n    }\n\n    /**\n     * 继续填写单号内容变化时，判断是否内容为空\n     */\n    applyContinueEditOnChange=(e:ChangeEvent<HTMLInputElement>)=>{\n        this.setState({\n            inputSerialNumber:e.target.value\n        });\n    }\n\n    /**\n     * 录入单号回车事件\n     */\n    applyContinueEditFromInputEnter=(event:KeyboardEvent)=>{\n        if(this.state.inputSerialNumber===\"\"){\n            this.setState({serialNumberExist:true});\n            return;\n        }\n        if(!event||event.key!==\"Enter\") return;\n        this.applyContinueEdit();\n    }\n\n    /**\n     * 继续编写申请内容\n     */\n    applyContinueEdit=async ()=>{\n        //请求中\n        this.setState({loading:{continueEdit:true}});\n        const serialNumber=this.state.inputSerialNumber;\n\n        type applyExistResponseData={exist:boolean,commit:boolean,applyType:number};\n        const applyExist:HttpResponse<applyExistResponseData>=\n            await ((new HttpRequest()).get<applyExistResponseData>(\n                `webapi/apply/existApplyNo?applyNo=${serialNumber}`\n            ));\n        //获取出错\n        if(!applyExist.success){\n            this.setState({\n                modalVisible:true,\n                modalErrorMessage:applyExist.message,\n                loading:{\n                    continueEdit:false\n                }\n            });\n        }\n\n        const exist=applyExist.data&&applyExist.data.exist;\n        this.setState({\n            loading:{\n                continueEdit:false,\n            },\n            serialNumberExist:exist\n        });\n\n        //存在，进入编辑页面\n        if(exist&&applyExist.data){\n            const applyType=ApplyType.create(applyExist.data.applyType);\n            const defaultRoute=applyType===ApplyType.RECORD\n                ?ApplyStep.RECORD_COMMITMENT.routePath(serialNumber)\n                :ApplyStep.LICENSE_COMMITMENT.routePath(serialNumber);\n            //如果在审核中，进入结果页面\n            if(applyExist.data.commit){\n                this.props.history.push(defaultRoute);\n            }\n            //如果在编写中，进入编辑步骤页面\n            else{\n                const applyEditCached=DataCache.instance.edit(serialNumber);\n                this.props.history.push(applyEditCached\n                    ?applyEditCached.step.routePath(serialNumber)\n                    :defaultRoute\n                );\n            }\n        }\n    }\n\n    /**\n     * 点击图片全屏查看流程图\n     */\n    viewImage=(event:MouseEvent<HTMLImageElement>)=>{\n        const img:HTMLImageElement=event.target;\n        \n    }\n\n    /**\n     * 创建备案申请\n     */\n    applyCreateRecord=async ()=>{\n        // 请求中\n        this.setState({loading:{applyRecord:true}});\n        \n        //获取申请单号\n        try{\n            const {applyNo}=await this.requestCreateApply(ApplyType.RECORD);\n            this.props.history.push(`/public/record/step-commitment/${applyNo}`);\n        }\n        catch(error){}\n    }\n\n    /**\n     * 创建许可申请\n     */\n    applyCreateLicense=async ()=>{\n        // 请求中\n        this.setState({loading:{applyLicense:true}});\n        \n        //获取申请单号\n        try{\n            const {applyNo}=await this.requestCreateApply(ApplyType.LICENSE);\n            this.props.history.push(`/public/license/step-commitment/${applyNo}`);\n        }\n        catch(error){}\n    }\n\n    /**\n     * 发起请求创建申请单\n     */\n    private requestCreateApply=async (type:ApplyType):Promise<ApplyContent>=>{\n        const createdApply:HttpResponse<ApplyContent>=\n            await ((new HttpRequest()).get<ApplyContent>(\n                `webapi/apply/applyNo?applyType=${type.key}`\n            ));\n        //创建失败\n        if(!createdApply.success){\n            this.setState({\n                modalVisible:true,\n                modalErrorMessage:createdApply.message,\n                loading:{\n                    continueEdit:false,\n                    applyRecord:false,\n                    applyLicense:false\n                }\n            });\n            throw new Error(createdApply.message);\n        }\n        return new Promise<ApplyContent>(\n            (resolve, reject)=>resolve(createdApply.data)\n        );\n    }\n}\nexport default withRouter((Form.create({name:\"pageSwitch\"})(Switch)) as any);"]},"metadata":{},"sourceType":"module"}