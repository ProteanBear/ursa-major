{"ast":null,"code":"import \"antd/es/alert/style/css\";\nimport _Alert from \"antd/es/alert\";\nimport \"antd/es/row/style/css\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/upload/style/css\";\nimport _Upload from \"antd/es/upload\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/radio/style/css\";\nimport _Radio from \"antd/es/radio\";\nimport \"antd/es/col/style/css\";\nimport _Col from \"antd/es/col\";\nimport \"antd/es/form/style/css\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style/css\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/divider/style/css\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/breadcrumb/style/css\";\nimport _Breadcrumb from \"antd/es/breadcrumb\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/select/style/css\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/typography/style/css\";\nimport _Typography from \"antd/es/typography\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/notification/style/css\";\nimport _notification from \"antd/es/notification\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport _objectSpread from \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/maqiang/\\u7F16\\u7A0B/yzwj-recorder-web/src/pages/public/RecordOrganization.tsx\";\nimport React from 'react';\nimport Container, { ContainerLoading } from '../../components/Container';\nimport { ApplySectionPrompt, ApplySectionRecordStep } from '../../components/ApplyHeader';\nimport ApplyFormEquipment from '../../components/ApplyFormEquipment';\nimport { DictionaryLoader } from '../../app/DictionaryLoader';\nimport { ApplyFormMedical, ApplyFormMedicalTypeContext, ApplyFormMedicalType } from '../../components/ApplyFormMedical';\nimport { ApplyStep, PageError500 } from '../../app/Model';\nimport { HttpRequest } from '../../app/Request';\nimport InteractionUtils from '../../utils/InteractionUtils';\nimport ApplyUtils from '../../utils/ApplyUtils';\nimport ImageViewer from '../../components/ImageViewer';\nimport Text from 'antd/lib/typography/Text';\nimport { Link } from 'react-router-dom';\nconst addressPrefix = \"四川省成都市高新区\";\n/**\n * 备案流程：第二步，机构信息\n */\n\nclass RecordOrganization extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      serialNumber: this.props.match.params.id,\n      loading: false,\n      saved: true,\n      hasFileValidateError: false,\n      fileList: {\n        \"waste\": [],\n        \"regulation\": [],\n        \"license\": [],\n        \"building\": []\n      },\n      uploadSuccess: {\n        \"waste\": true,\n        \"regulation\": true,\n        \"license\": true,\n        \"building\": true\n      },\n      uploadLimit: {\n        \"waste\": 1,\n        \"regulation\": 1,\n        \"license\": 20,\n        \"building\": 20\n      },\n      alert: {\n        show: false,\n        title: \"\",\n        description: \"\"\n      }\n      /**\n       * 上传组件配置：图片\n       */\n\n    };\n    this.uploadPhotoConfig = {\n      accept: \".jpg,.png\",\n      listType: \"picture-card\",\n      className: \"avatar-uploader\",\n      showUploadList: true\n      /**\n       * 上传组件配置：文档\n       */\n\n    };\n    this.uploadFileConfig = {\n      accept: \".doc,.docx,.pdf\",\n      multiple: true\n      /**\n       * 页面布局\n       */\n\n    };\n\n    this.inputOnChange = () => {\n      this.setState(_objectSpread({}, this.state, {\n        saved: false\n      }));\n    };\n\n    this.equipmentChangeHandler = equipments => {\n      if (!this.state.data) return;\n      this.setState(_objectSpread({}, this.state, {\n        saved: false,\n        data: _objectSpread({}, this.state.data, {\n          equipments: equipments\n        })\n      }));\n    };\n\n    this.scopeChangeHandler = (scope, description) => {\n      if (!this.state.data) return;\n      this.setState(_objectSpread({}, this.state, {\n        saved: false,\n        data: _objectSpread({}, this.state.data, {\n          diagnosisSubjectCode: scope,\n          diagnosisSubjectName: description\n        })\n      }));\n    };\n\n    this.uploadFileOrPhoto = async (fileObject, key) => {\n      // 上传文件或图片\n      const option = fileObject;\n      const uploadResponse = await new HttpRequest().upload(\"webapi/comm/uploadFile\", option.file, \"file\", {\n        applyNo: this.state.serialNumber\n      });\n      const uploadSuccess = this.state.uploadSuccess;\n      uploadSuccess[key] = uploadResponse.success && uploadResponse.data !== null; //上传失败显示\n\n      if (!uploadSuccess[key] || !uploadResponse.data) {\n        this.setState(_objectSpread({}, this.state, {\n          uploadSuccess: uploadSuccess\n        }));\n        return;\n      } //上传成功，设置已上传列表\n\n\n      const fileList = this.state.fileList;\n      fileList[key].push({\n        uid: String(fileList[key].length),\n        name: option.file.name,\n        size: 0,\n        type: \"\",\n        url: uploadResponse.data.url\n      });\n      this.setState(_objectSpread({}, this.state, {\n        uploadSuccess: uploadSuccess,\n        saved: false,\n        fileList: fileList\n      }));\n    };\n\n    this.uploadPhotoPreview = (uploadFile, key) => {\n      // 获取全部上传的图片元素\n      const row = document.querySelector(\".\".concat(key, \"-photos\"));\n      if (!row) return;\n      const imgArray = row.querySelectorAll(\".ant-upload-list-item-image\");\n      const imageList = [];\n      let currentIndex = 0;\n      imgArray.forEach((img, index) => {\n        imageList.push(img);\n        currentIndex = index === Number(uploadFile.uid) ? index : currentIndex;\n      });\n      ImageViewer.view(imageList, currentIndex);\n    };\n\n    this.uploadFileOrPhotoRemove = (file, key) => {\n      const confirm = _Modal.confirm;\n      const fileList = this.state.fileList;\n      confirm({\n        title: '确定要删除当前上传的文件或图片么？',\n        okText: '继续删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk: () => {\n          fileList[key].splice(fileList[key].findIndex(item => item.uid === file.uid), 1);\n          this.setState(_objectSpread({}, this.state, {\n            saved: false,\n            fileList: fileList\n          }));\n        }\n      });\n    };\n\n    this.prevStep = () => {\n      const toPrevStep = () => {\n        _notification.destroy();\n\n        InteractionUtils.scrollToTop();\n        this.props.history.push(ApplyStep.RECORD_COMMITMENT.routePath(this.state.serialNumber));\n      };\n\n      if (!this.state.saved) {\n        _Modal.confirm({\n          title: \"确定要离开这里么?\",\n          content: \"未保存的信息将会丢失！\",\n          okText: \"继续离开\",\n          cancelText: \"取消\",\n\n          onOk() {\n            toPrevStep();\n          }\n\n        });\n\n        return;\n      }\n\n      toPrevStep();\n    };\n\n    this.saveCommitmentAndNext = () => {\n      //基础信息表单校验\n      this.props.form.validateFieldsAndScroll(async (error, values) => {\n        this.setState(_objectSpread({}, this.state, {\n          alert: {\n            show: false\n          }\n        }));\n        if (!this.state.data) return;\n\n        if (!error) {\n          //诊疗范围选择校验\n          if (this.state.data.diagnosisSubjectCode === \"\") {\n            _message.error(\"验证错误！请至少选中一个诊疗范围！\");\n\n            return;\n          } //上传文件或图片验证\n\n\n          const fileList = this.state.fileList;\n          let hasError = false;\n\n          for (const key in fileList) {\n            if (fileList.hasOwnProperty(key)) {\n              if (fileList[key].length < 1) {\n                hasError = true;\n                break;\n              }\n            }\n          }\n\n          if (hasError) {\n            this.setState(_objectSpread({}, this.state, {\n              hasFileValidateError: true\n            }));\n            return;\n          } // 发起保存请求\n\n\n          this.setState(_objectSpread({}, this.state, {\n            loading: true\n          }));\n          values.address = addressPrefix + values.address;\n          const saveResponse = await new HttpRequest().post(\"webapi/apply/saveRecordInfo\", _objectSpread({}, values, {\n            applyNo: this.state.serialNumber,\n            equipments: this.state.data.equipments,\n            diagnosisSubjectCode: this.state.data.diagnosisSubjectCode,\n            diagnosisSubjectName: this.state.data.diagnosisSubjectName,\n            medicalWasteAgreement: ApplyUtils.uploadArrayToUrlString(fileList.waste),\n            managerment: ApplyUtils.uploadArrayToUrlString(fileList.regulation),\n            businessLicense: ApplyUtils.uploadArrayToUrlString(fileList.license),\n            orgFlatImg: ApplyUtils.uploadArrayToUrlString(fileList.building)\n          })); //请求失败显示错误信息\n\n          if (!saveResponse.success) {\n            this.setState(_objectSpread({}, this.state, {\n              loading: false,\n              alert: {\n                show: true,\n                title: \"保存失败\",\n                description: saveResponse.message\n              }\n            }));\n            return;\n          } //成功后转入下一步\n\n\n          this.setState(_objectSpread({}, this.state, {\n            loading: false\n          }));\n\n          _notification.destroy();\n\n          InteractionUtils.scrollToTop();\n          this.props.history.push(ApplyStep.RECORD_STAFF.routePath(this.state.serialNumber));\n        }\n      });\n    };\n  }\n\n  render() {\n    //未载入数据时\n    if (!this.state.data) {\n      return React.createElement(ContainerLoading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      });\n    }\n\n    const Title = _Typography.Title;\n    const Option = _Select.Option;\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const content = this.state.data;\n    const street = DictionaryLoader.instance.street();\n    const subjection = DictionaryLoader.instance.subjection();\n    const ownership = DictionaryLoader.instance.ownership();\n    return React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb, {\n      className: \"breadcrumb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/public\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"file-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), \"\\xA0\", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, \"\\u6267\\u4E1A\\u7533\\u8BF7\"))), React.createElement(_Breadcrumb.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"\\u5907\\u6848\"))), React.createElement(Title, {\n      level: 4,\n      className: \"title-with-underline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"\\u5907\\u6848\\u7533\\u8BF7\"), React.createElement(ApplySectionPrompt, {\n      serialNumber: this.state.serialNumber,\n      deadline: content.effectiveTimeStr,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(ApplySectionRecordStep, Object.assign({}, ApplyStep.RECORD_ORGANIZATION, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    })), React.createElement(_Divider, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"title-inner\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \"\\u7B2C\\u4E8C\\u6B65\\uFF1A\\u673A\\u6784\\u4FE1\\u606F\")), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"\\u57FA\\u672C\\u4FE1\\u606F\"), React.createElement(_Form, {\n      layout: \"vertical\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(_Col, {\n      span: 15,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u8BCA\\u6240\\u540D\\u79F0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, getFieldDecorator(\"name\", {\n      initialValue: content.name,\n      rules: [{\n        required: true,\n        message: \"诊所名称不能为空!\"\n      }]\n    })(React.createElement(_Input, {\n      name: \"name\",\n      placeholder: \"\\u8BF7\\u8F93\\u5165\",\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    })))), React.createElement(_Col, {\n      span: 8,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u6240\\u5C5E\\u8857\\u9053\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, getFieldDecorator(\"street\", {\n      initialValue: \"\" === content.street ? undefined : content.street,\n      rules: [{\n        required: true,\n        message: \"必须选择所属的街道！\"\n      }]\n    })(React.createElement(_Select, {\n      showSearch: true,\n      placeholder: \"\\u9009\\u62E9\\u673A\\u6784\\u6240\\u5C5E\\u7684\\uFF08\\u9AD8\\u65B0\\u533A\\uFF09\\u8857\\u9053\",\n      optionFilterProp: \"children\",\n      filterOption: (input, option) => option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, street.map((data, index) => {\n      return React.createElement(Option, {\n        key: data.value,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, data.label);\n    }))))), React.createElement(_Col, {\n      span: 7,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u673A\\u6784\\u5730\\u5740\",\n      help: \"\\u8BF7\\u8F93\\u5165\\u8BE6\\u7EC6\\u7684\\u5730\\u5740\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(_Col, {\n      span: 8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      value: \"\\u56DB\\u5DDD\\u7701\",\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      value: \"\\u6210\\u90FD\\u5E02\",\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      value: \"\\u9AD8\\u65B0\\u533A\",\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 24,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, getFieldDecorator(\"address\", {\n      initialValue: content.address.replace(addressPrefix, \"\"),\n      rules: [{\n        required: true,\n        message: \"机构地址不能为空！\"\n      }]\n    })(React.createElement(_Input.TextArea, {\n      rows: 3,\n      style: {\n        maxHeight: 73\n      },\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    })))))), React.createElement(_Col, {\n      span: 7,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u7EDF\\u4E00\\u793E\\u4F1A\\u4FE1\\u7528\\u4EE3\\u7801\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, getFieldDecorator(\"onlyCode\", {\n      initialValue: content.onlyCode,\n      rules: [{\n        required: true,\n        message: \"统一社会信用代码不能为空！\"\n      }]\n    })(React.createElement(_Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\",\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }))), React.createElement(_Form.Item, {\n      label: \"\\u96B6\\u5C5E\\u5173\\u7CFB\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, getFieldDecorator(\"membership\", {\n      initialValue: \"\" === content.membership ? undefined : content.membership,\n      rules: [{\n        required: true,\n        message: \"必须选择隶属关系！\"\n      }]\n    })(React.createElement(_Select, {\n      showSearch: true,\n      placeholder: \"\\u8BF7\\u9009\\u62E9\",\n      optionFilterProp: \"children\",\n      filterOption: (input, option) => option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, subjection.map((data, index) => {\n      return React.createElement(Option, {\n        key: data.value,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, data.label);\n    }))))), React.createElement(_Col, {\n      span: 8,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u6240\\u6709\\u5236\\u6027\\u8D28\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, getFieldDecorator(\"ownership\", {\n      initialValue: \"\" === content.ownership ? undefined : content.ownership,\n      rules: [{\n        required: true,\n        message: \"必须选择所有制性质\"\n      }]\n    })(React.createElement(_Select, {\n      showSearch: true,\n      placeholder: \"\\u8BF7\\u9009\\u62E9\",\n      optionFilterProp: \"children\",\n      filterOption: (input, option) => option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, ownership.map((data, index) => {\n      return React.createElement(Option, {\n        key: data.value,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, data.label);\n    })))), React.createElement(_Form.Item, {\n      label: \"\\u7ECF\\u8425\\u6027\\u8D28\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, getFieldDecorator(\"natureOperation\", {\n      initialValue: \"\" === content.natureOperation ? \"营利性\" : content.natureOperation,\n      rules: [{\n        required: false\n      }]\n    })(React.createElement(_Radio.Group, {\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, React.createElement(_Radio, {\n      value: \"\\u975E\\u8425\\u5229\\u6027\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, \"\\u975E\\u8425\\u5229\\u6027\"), React.createElement(_Radio, {\n      value: \"\\u8425\\u5229\\u6027\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }, \"\\u8425\\u5229\\u6027\"))))), React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u4E2D\\u533B\\u8BCA\\u7597\\u6280\\u672F\\u548C\\u65B9\\u6848\",\n      help: \"\\u586B\\u5199\\u5185\\u5BB9\\u96501000\\u5B57\\u4EE5\\u5185\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, getFieldDecorator(\"medicineTechnology\", {\n      initialValue: content.medicineTechnology,\n      rules: [{\n        required: false\n      }]\n    })(React.createElement(_Input.TextArea, {\n      rows: 5,\n      style: {\n        maxHeight: 115\n      },\n      onChange: this.inputOnChange,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    })))))), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, \"\\u8BBE\\u5907\\u6E05\\u5355\"), React.createElement(ApplyFormEquipment, {\n      onChange: this.equipmentChangeHandler,\n      equiptments: this.state.data.equipments,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    })), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }, \"\\u8BCA\\u7597\\u8303\\u56F4\", React.createElement(Text, {\n      type: \"secondary\",\n      style: {\n        fontSize: 13\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, \"\\uFF08\\u81F3\\u5C11\\u9009\\u4E2D\\u4E00\\u9879\\uFF09\")), React.createElement(ApplyFormMedicalTypeContext.Provider, {\n      value: {\n        type: ApplyFormMedicalType.SIMPLE\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, React.createElement(ApplyFormMedical, {\n      scope: this.state.data.diagnosisSubjectCode,\n      onChange: this.scopeChangeHandler,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 314\n      },\n      __self: this\n    }))), React.createElement(_Col, {\n      span: 22,\n      offset: 1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"title-form-sub\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, \"\\u4E0A\\u4F20\\u5185\\u5BB9\"), React.createElement(_Form, {\n      labelCol: {\n        span: 7\n      },\n      wrapperCol: {\n        span: 17\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    }, React.createElement(_Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326\n      },\n      __self: this\n    }, React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u533B\\u7597\\u5E9F\\u7269\\u670D\\u52A1\\u534F\\u8BAE\",\n      className: \"must-upload\",\n      validateStatus: !this.state.hasFileValidateError ? this.state.uploadSuccess.waste ? \"\" : \"error\" : this.state.fileList.waste.length > 0 ? \"\" : \"error\",\n      help: !this.state.hasFileValidateError ? this.state.uploadSuccess.waste ? \"支持扩展名：.doc .docx .pdf\" : \"文件上传失败！\" : this.state.fileList.waste.length > 0 ? \"支持扩展名：.doc .docx .pdf\" : \"必须上传此文件！\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, React.createElement(_Upload, Object.assign({}, this.uploadFileConfig, {\n      name: \"waste\",\n      customRequest: fileObject => {\n        this.uploadFileOrPhoto(fileObject, \"waste\");\n      },\n      onRemove: file => {\n        this.uploadFileOrPhotoRemove(file, \"waste\");\n      },\n      fileList: this.state.fileList.waste,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }), this.state.uploadLimit.waste > this.state.fileList.waste.length ? React.createElement(_Button, {\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"upload\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }), \"\\u4E0A\\u4F20\\u6587\\u4EF6\") : null))), React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      label: \"\\u673A\\u6784\\u5236\\u5EA6\",\n      className: \"must-upload\",\n      validateStatus: !this.state.hasFileValidateError ? this.state.uploadSuccess.regulation ? \"\" : \"error\" : this.state.fileList.regulation.length > 0 ? \"\" : \"error\",\n      help: !this.state.hasFileValidateError ? this.state.uploadSuccess.regulation ? \"支持扩展名：.doc .docx .pdf\" : \"文件上传失败！\" : this.state.fileList.regulation.length > 0 ? \"支持扩展名：.doc .docx .pdf\" : \"必须上传此文件！\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, React.createElement(_Upload, Object.assign({}, this.uploadFileConfig, {\n      name: \"regulation\",\n      customRequest: fileObject => {\n        this.uploadFileOrPhoto(fileObject, \"regulation\");\n      },\n      onRemove: file => {\n        this.uploadFileOrPhotoRemove(file, \"regulation\");\n      },\n      fileList: this.state.fileList.regulation,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372\n      },\n      __self: this\n    }), this.state.uploadLimit.regulation > this.state.fileList.regulation.length ? React.createElement(_Button, {\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"upload\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    }), \"\\u4E0A\\u4F20\\u6587\\u4EF6\") : null)))), React.createElement(_Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390\n      },\n      __self: this\n    }, React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      className: \"license-photos must-upload\",\n      label: \"\\u8425\\u4E1A\\u6267\\u7167\",\n      validateStatus: !this.state.hasFileValidateError ? this.state.uploadSuccess.license ? \"\" : \"error\" : this.state.fileList.license.length > 0 ? \"\" : \"error\",\n      help: !this.state.hasFileValidateError ? this.state.uploadSuccess.license ? \"支持扩展名：.jpg .png\" : \"图片上传失败！\" : this.state.fileList.license.length > 0 ? \"支持扩展名：.jpg .png\" : \"必须上传此图片！\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    }, React.createElement(_Upload, Object.assign({}, this.uploadPhotoConfig, {\n      name: \"license\",\n      customRequest: fileObject => {\n        this.uploadFileOrPhoto(fileObject, \"license\");\n      },\n      onRemove: file => {\n        this.uploadFileOrPhotoRemove(file, \"license\");\n      },\n      onPreview: file => {\n        this.uploadPhotoPreview(file, \"license\");\n      },\n      fileList: this.state.fileList.license,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405\n      },\n      __self: this\n    }), this.state.uploadLimit.license > this.state.fileList.license.length ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 421\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ant-upload-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423\n      },\n      __self: this\n    }, \"\\u4E0A\\u4F20\")) : null))), React.createElement(_Col, {\n      span: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430\n      },\n      __self: this\n    }, React.createElement(_Form.Item, {\n      className: \"building-photos must-upload\",\n      label: \"\\u623F\\u5C4B\\u5E73\\u9762\\u5E03\\u5C40\\u56FE\",\n      validateStatus: !this.state.hasFileValidateError ? this.state.uploadSuccess.license ? \"\" : \"error\" : this.state.fileList.license.length > 0 ? \"\" : \"error\",\n      help: !this.state.hasFileValidateError ? this.state.uploadSuccess.license ? \"支持扩展名：.jpg .png\" : \"图片上传失败！\" : this.state.fileList.license.length > 0 ? \"支持扩展名：.jpg .png\" : \"必须上传此图片！\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431\n      },\n      __self: this\n    }, React.createElement(_Upload, Object.assign({}, this.uploadPhotoConfig, {\n      name: \"building\",\n      customRequest: fileObject => {\n        this.uploadFileOrPhoto(fileObject, \"building\");\n      },\n      onRemove: file => {\n        this.uploadFileOrPhotoRemove(file, \"building\");\n      },\n      onPreview: file => {\n        this.uploadPhotoPreview(file, \"building\");\n      },\n      fileList: this.state.fileList.building,\n      disabled: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444\n      },\n      __self: this\n    }), this.state.uploadLimit.building > this.state.fileList.building.length ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 461\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ant-upload-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 462\n      },\n      __self: this\n    }, \"\\u4E0A\\u4F20\")) : null)))))), this.state.alert.show ? React.createElement(_Col, {\n      span: 12,\n      offset: 6,\n      style: {\n        marginTop: 10\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475\n      },\n      __self: this\n    }, React.createElement(_Alert, {\n      message: this.state.alert.title,\n      description: this.state.alert.description,\n      type: \"error\",\n      showIcon: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 476\n      },\n      __self: this\n    })) : null, React.createElement(_Col, {\n      span: 24,\n      className: \"section-buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      onClick: this.prevStep,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 487\n      },\n      __self: this\n    }, \"\\u4E0A\\u4E00\\u6B65\"), React.createElement(_Button, {\n      type: \"primary\",\n      onClick: this.saveCommitmentAndNext,\n      loading: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488\n      },\n      __self: this\n    }, \"\\u4FDD\\u5B58\\u5E76\\u8FDB\\u5165\\u4E0B\\u4E00\\u6B65\")));\n  }\n  /**\n   * 组件完成后请求获取申请信息\n   */\n\n\n  async componentDidMount() {\n    // 获取申请内容\n    const applyResponse = await new HttpRequest().get(\"webapi/apply/getRecordInfo?applyNo=\".concat(this.state.serialNumber)); // 失败跳转500\n\n    if (!applyResponse.success || !applyResponse.data) {\n      this.props.history.push(PageError500);\n      return;\n    } // 不可编辑跳转审核结果\n\n\n    const applyStatus = applyResponse.data.applyStatus;\n\n    if (!ApplyUtils.canEdit(applyStatus)) {\n      this.props.history.push(ApplyStep.RECORD_RESULT.routePath(this.state.serialNumber));\n      return;\n    } // 处理文件路径拆分\n\n\n    let _this$state$fileList = this.state.fileList,\n        waste = _this$state$fileList.waste,\n        regulation = _this$state$fileList.regulation,\n        license = _this$state$fileList.license,\n        building = _this$state$fileList.building;\n    waste = ApplyUtils.urlStringToUploadArray(waste, applyResponse.data.medicalWasteAgreement);\n    regulation = ApplyUtils.urlStringToUploadArray(regulation, applyResponse.data.managerment);\n    license = ApplyUtils.urlStringToUploadArray(license, applyResponse.data.businessLicense);\n    building = ApplyUtils.urlStringToUploadArray(building, applyResponse.data.orgFlatImg); // 设置显示\n\n    this.setState(_objectSpread({}, this.state, {\n      data: applyResponse.data,\n      fileList: {\n        waste: waste,\n        regulation: regulation,\n        license: license,\n        building: building\n      }\n    })); // 添加窗口关闭监听\n\n    InteractionUtils.addWindowCloseListener(event => {\n      if (this.state.saved) event.preventDefault();else event.returnValue = true;\n    }); // 审核被驳回，获取驳回理由\n\n    if (ApplyUtils.needLoadReject(applyStatus)) {\n      const rejectArrayResponse = await new HttpRequest().get(\"webapi/apply/auditOpinion?applyNo=\".concat(this.state.serialNumber)); // 失败\n\n      if (!rejectArrayResponse.success || !rejectArrayResponse.data) {\n        return;\n      } // 找到最新的拒绝内容\n\n\n      let rejectContent = null;\n\n      for (let l = rejectArrayResponse.data.length, i = l - 1; i > -1; i--) {\n        const current = rejectArrayResponse.data[i];\n\n        if (ApplyUtils.inspectIsReject(current.status)) {\n          rejectContent = current;\n          break;\n        }\n      } //通知显示拒绝理由\n\n\n      if (!rejectContent) return;\n\n      _notification[\"warning\"]({\n        message: \"申请被驳回！\",\n        description: rejectContent.opinion\n      });\n    }\n  }\n  /**\n   * 卸载时删除窗口关闭监听\n   */\n\n\n  componentWillUnmount() {\n    InteractionUtils.removeWindowCloseListener();\n  }\n  /**\n   * 输入信息修改，设置是否保存为false\n   */\n\n\n}\n\nexport default _Form.create({\n  name: \"recordOrganization\"\n})(RecordOrganization);","map":{"version":3,"sources":["/Users/maqiang/编程/yzwj-recorder-web/src/pages/public/RecordOrganization.tsx"],"names":["React","Container","ContainerLoading","ApplySectionPrompt","ApplySectionRecordStep","ApplyFormEquipment","DictionaryLoader","ApplyFormMedical","ApplyFormMedicalTypeContext","ApplyFormMedicalType","ApplyStep","PageError500","HttpRequest","InteractionUtils","ApplyUtils","ImageViewer","Text","Link","addressPrefix","RecordOrganization","Component","state","serialNumber","props","match","params","id","loading","saved","hasFileValidateError","fileList","uploadSuccess","uploadLimit","alert","show","title","description","uploadPhotoConfig","accept","listType","className","showUploadList","uploadFileConfig","multiple","inputOnChange","setState","equipmentChangeHandler","equipments","data","scopeChangeHandler","scope","diagnosisSubjectCode","diagnosisSubjectName","uploadFileOrPhoto","fileObject","key","option","uploadResponse","upload","file","applyNo","success","push","uid","String","length","name","size","type","url","uploadPhotoPreview","uploadFile","row","document","querySelector","imgArray","querySelectorAll","imageList","currentIndex","forEach","img","index","Number","view","uploadFileOrPhotoRemove","confirm","okText","okType","cancelText","onOk","splice","findIndex","item","prevStep","toPrevStep","destroy","scrollToTop","history","RECORD_COMMITMENT","routePath","content","saveCommitmentAndNext","form","validateFieldsAndScroll","error","values","hasError","hasOwnProperty","address","saveResponse","post","medicalWasteAgreement","uploadArrayToUrlString","waste","managerment","regulation","businessLicense","license","orgFlatImg","building","message","RECORD_STAFF","render","Title","Option","getFieldDecorator","street","instance","subjection","ownership","effectiveTimeStr","RECORD_ORGANIZATION","initialValue","rules","required","undefined","input","children","toLowerCase","indexOf","map","value","label","replace","maxHeight","onlyCode","membership","natureOperation","medicineTechnology","fontSize","SIMPLE","span","marginTop","componentDidMount","applyResponse","get","applyStatus","canEdit","RECORD_RESULT","urlStringToUploadArray","addWindowCloseListener","event","preventDefault","returnValue","needLoadReject","rejectArrayResponse","rejectContent","l","i","current","inspectIsReject","status","opinion","componentWillUnmount","removeWindowCloseListener","create"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Breadcrumb,Icon,Typography, Button,Divider,Col, Form, Input, Select,Radio, Upload, Row, Modal, notification, Alert, message } from 'antd';\n\nimport Container, { ContainerLoading } from '../../components/Container';\nimport {ApplySectionPrompt,ApplySectionRecordStep} from '../../components/ApplyHeader';\nimport ApplyFormEquipment from '../../components/ApplyFormEquipment';\nimport {DictionaryData,DictionaryLoader} from '../../app/DictionaryLoader';\nimport {ApplyFormMedical,ApplyFormMedicalTypeContext,ApplyFormMedicalType } from '../../components/ApplyFormMedical';\nimport { ApplyStep, AppComponentProps, ApplyContentOrganization, PageError500, ApplyContentEquipment, ApplyInspectContent } from '../../app/Model';\nimport { HttpResponse, HttpRequest } from '../../app/Request';\nimport InteractionUtils from '../../utils/InteractionUtils';\nimport ApplyUtils from '../../utils/ApplyUtils';\nimport { UploadProps } from 'antd/lib/upload';\nimport { UploadFile } from 'antd/lib/upload/interface';\nimport ImageViewer from '../../components/ImageViewer';\nimport Text from 'antd/lib/typography/Text';\nimport { Link } from 'react-router-dom';\n\nconst addressPrefix=\"四川省成都市高新区\";\n\n/**\n * 备案流程：第二步，机构信息\n */\nclass RecordOrganization extends React.Component<AppComponentProps>{\n    readonly state:{\n        /**申请单号 */\n        serialNumber:string;\n        /**保存按钮是否请求中 */\n        loading:boolean;\n        /**是否已经保存 */\n        saved:boolean;\n        /**文件上传验证错误 */\n        hasFileValidateError:boolean;\n        /**申请内容 */\n        data?:ApplyContentOrganization;\n        /**上传文件列表 */\n        fileList:{\n            [key:string]:Array<UploadFile>\n        };\n        /**上传是否成功 */\n        uploadSuccess:{\n            [key:string]:boolean\n        };\n        /**上传的数量限制 */\n        uploadLimit:{\n            [key:string]:number\n        }\n        /**弹出信息提示 */\n        alert:{\n            show:boolean,\n            title:string,\n            description:string\n        }\n    }={\n        serialNumber:this.props.match.params.id,\n        loading:false,\n        saved:true,\n        hasFileValidateError:false,\n        fileList:{\n            \"waste\":[],\n            \"regulation\":[],\n            \"license\":[],\n            \"building\":[]\n        },\n        uploadSuccess:{\n            \"waste\":true,\n            \"regulation\":true,\n            \"license\":true,\n            \"building\":true\n        },\n        uploadLimit:{\n            \"waste\":1,\n            \"regulation\":1,\n            \"license\":20,\n            \"building\":20\n        },\n        alert:{show:false,title:\"\",description:\"\"}\n    }\n\n    /**\n     * 上传组件配置：图片\n     */\n    private readonly uploadPhotoConfig:UploadProps={\n        accept:\".jpg,.png\",\n        listType:\"picture-card\",\n        className:\"avatar-uploader\",\n        showUploadList:true,\n    }\n\n    /**\n     * 上传组件配置：文档\n     */\n    private readonly uploadFileConfig:UploadProps={\n        accept:\".doc,.docx,.pdf\",\n        multiple:true,\n    }\n\n    /**\n     * 页面布局\n     */\n    render(){\n        //未载入数据时\n        if(!this.state.data){\n            return (\n                <ContainerLoading />\n            );\n        }\n\n        const {Title}=Typography;\n        const {Option}=Select;\n        const {getFieldDecorator} = this.props.form;\n\n        const content=this.state.data;\n        const street:Array<DictionaryData>=DictionaryLoader.instance.street();\n        const subjection:Array<DictionaryData>=DictionaryLoader.instance.subjection();\n        const ownership:Array<DictionaryData>=DictionaryLoader.instance.ownership();\n\n        return (\n            <Container>\n                {/* 标题 */}\n                <Breadcrumb className=\"breadcrumb\">\n                    <Breadcrumb.Item>\n                        <Link to=\"/public\">\n                            <Icon type=\"file-text\"/>&nbsp;\n                            <span>执业申请</span>\n                        </Link>\n                    </Breadcrumb.Item>\n                    <Breadcrumb.Item><span>备案</span></Breadcrumb.Item>\n                </Breadcrumb>\n                <Title level={4} className=\"title-with-underline\">备案申请</Title>\n\n                {/* 顶部 */}\n                <ApplySectionPrompt serialNumber={this.state.serialNumber} \n                    deadline={content.effectiveTimeStr} />\n                <ApplySectionRecordStep {...ApplyStep.RECORD_ORGANIZATION} />\n                <Divider><span className=\"title-inner\">第二步：机构信息</span></Divider>\n\n                {/* 表单：基本信息 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">基本信息</h4>\n                    <Form layout=\"vertical\">\n                        <Col span={15}>\n                            <Form.Item label=\"诊所名称\">{\n                                getFieldDecorator(\"name\",{\n                                    initialValue:content.name,\n                                    rules:[\n                                        {required:true,message:\"诊所名称不能为空!\"}\n                                    ]\n                                })(\n                                    <Input name=\"name\" placeholder=\"请输入\" \n                                        onChange={this.inputOnChange} \n                                        disabled={this.state.loading}\n                                    />\n                                )}\n                            </Form.Item>\n                        </Col>\n                        <Col span={8} offset={1}>\n                            <Form.Item label=\"所属街道\">{\n                                getFieldDecorator(\"street\",{\n                                    initialValue:(\"\"===content.street?undefined:content.street),\n                                    rules:[\n                                        {required:true,message:\"必须选择所属的街道！\"}\n                                    ]\n                                })(\n                                    <Select showSearch\n                                        placeholder=\"选择机构所属的（高新区）街道\"\n                                        optionFilterProp=\"children\"\n                                        filterOption={(input, option:React.ReactElement) =>\n                                            option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n                                        }\n                                        onChange={this.inputOnChange}\n                                        disabled={this.state.loading}\n                                    >\n                                        {street.map((data:DictionaryData,index:number)=>{\n                                            return (<Option key={data.value}>{data.label}</Option>);\n                                        })}\n                                    </Select>\n                                )}\n                            </Form.Item>\n                        </Col>\n                        <Col span={7}>\n                            <Form.Item label=\"机构地址\" help=\"请输入详细的地址\">\n                                <div className=\"input-group\">\n                                    <Col span={8}><Input value=\"四川省\" disabled/></Col>\n                                    <Col span={8}><Input value=\"成都市\" disabled/></Col>\n                                    <Col span={8}><Input value=\"高新区\" disabled/></Col>\n                                    <Col span={24}>{\n                                        getFieldDecorator(\"address\",{\n                                            initialValue:content.address.replace(addressPrefix,\"\"),\n                                            rules:[\n                                                {required:true,message:\"机构地址不能为空！\"}\n                                            ]\n                                        })(\n                                            <Input.TextArea rows={3} style={{maxHeight:73}} \n                                                onChange={this.inputOnChange} \n                                                disabled={this.state.loading}\n                                            />\n                                        )\n                                    } \n                                    </Col>\n                                </div>\n                            \n                            </Form.Item>\n                        </Col>\n                        <Col span={7} offset={1}>\n                            <Form.Item label=\"统一社会信用代码\">{\n                                getFieldDecorator(\"onlyCode\",{\n                                    initialValue:content.onlyCode,\n                                    rules:[\n                                        {required:true,message:\"统一社会信用代码不能为空！\"}\n                                    ]\n                                })(\n                                    <Input placeholder=\"请输入\" \n                                        onChange={this.inputOnChange}\n                                        disabled={this.state.loading}\n                                    />\n                                )}\n                            </Form.Item>\n                            <Form.Item label=\"隶属关系\">{\n                                getFieldDecorator(\"membership\",{\n                                    initialValue:(\"\"===content.membership?undefined:content.membership),\n                                    rules:[\n                                        {required:true,message:\"必须选择隶属关系！\"}\n                                    ]\n                                })(\n                                    <Select showSearch\n                                        placeholder=\"请选择\"\n                                        optionFilterProp=\"children\"\n                                        filterOption={(input, option:React.ReactElement) =>\n                                            option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n                                        }\n                                        onChange={this.inputOnChange}\n                                        disabled={this.state.loading}\n                                    >\n                                        {subjection.map((data:DictionaryData,index:number)=>{\n                                            return (<Option key={data.value}>{data.label}</Option>);\n                                        })}\n                                    </Select>\n                                )}\n                            </Form.Item>\n                        </Col>\n                        <Col span={8} offset={1}>\n                            <Form.Item label=\"所有制性质\">{\n                                getFieldDecorator(\"ownership\",{\n                                    initialValue:(\"\"===content.ownership?undefined:content.ownership),\n                                    rules:[\n                                        {required:true,message:\"必须选择所有制性质\"}\n                                    ]\n                                })(\n                                    <Select showSearch\n                                        placeholder=\"请选择\"\n                                        optionFilterProp=\"children\"\n                                        filterOption={(input, option:React.ReactElement) =>\n                                            option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n                                        }\n                                        onChange={this.inputOnChange}\n                                        disabled={this.state.loading}\n                                    >\n                                        {ownership.map((data:DictionaryData,index:number)=>{\n                                            return (<Option key={data.value}>{data.label}</Option>);\n                                        })}\n                                    </Select>\n                                )}\n                            </Form.Item>\n                            <Form.Item label=\"经营性质\">{\n                                getFieldDecorator(\"natureOperation\",{\n                                    initialValue:(\"\"===content.natureOperation?\"营利性\":content.natureOperation),\n                                    rules:[\n                                        {required:false}\n                                    ]\n                                })(\n                                    <Radio.Group onChange={this.inputOnChange} disabled={this.state.loading}>\n                                        <Radio value=\"非营利性\">非营利性</Radio>\n                                        <Radio value=\"营利性\">营利性</Radio>\n                                    </Radio.Group>\n                                )}\n                            </Form.Item>\n                        </Col>\n                        <Col span={12}>\n                            <Form.Item label=\"中医诊疗技术和方案\" help=\"填写内容限1000字以内\">{\n                                getFieldDecorator(\"medicineTechnology\",{\n                                    initialValue:content.medicineTechnology,\n                                    rules:[\n                                        {required:false}\n                                    ]\n                                })(\n                                    <Input.TextArea rows={5} style={{maxHeight:115}} \n                                        onChange={this.inputOnChange} \n                                        disabled={this.state.loading}\n                                    />\n                                )}\n                            </Form.Item>\n                        </Col>\n                    </Form>\n                </Col>\n\n                {/* 表单：设备清单 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">设备清单</h4>\n                    <ApplyFormEquipment \n                        onChange={this.equipmentChangeHandler}\n                        equiptments={this.state.data.equipments} \n                        disabled={this.state.loading}\n                    />\n                </Col>\n\n                {/* 表单：诊疗范围 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">\n                        诊疗范围\n                        <Text type=\"secondary\" style={{fontSize:13}}>（至少选中一项）</Text>\n                    </h4>\n                    <ApplyFormMedicalTypeContext.Provider value={{type:ApplyFormMedicalType.SIMPLE}}>\n                        <ApplyFormMedical \n                            scope={this.state.data.diagnosisSubjectCode} \n                            onChange={this.scopeChangeHandler}\n                            disabled={this.state.loading}\n                        />\n                    </ApplyFormMedicalTypeContext.Provider>\n                </Col>\n\n                {/* 表单：上传内容 */}\n                <Col span={22} offset={1}>\n                    <h4 className=\"title-form-sub\">上传内容</h4>\n                    <Form labelCol={{span:7}} wrapperCol={{span:17}}>\n                        <Row>\n                            <Col span={12}>\n                                <Form.Item \n                                    label=\"医疗废物服务协议\" className=\"must-upload\"\n                                    validateStatus={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.waste?\"\":\"error\")\n                                            :(this.state.fileList.waste.length>0?\"\":\"error\")\n                                    }\n                                    help={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.waste?\"支持扩展名：.doc .docx .pdf\":\"文件上传失败！\")\n                                            :(this.state.fileList.waste.length>0?\"支持扩展名：.doc .docx .pdf\":\"必须上传此文件！\")\n                                    }\n                                >\n                                    <Upload {...this.uploadFileConfig}\n                                        name=\"waste\"\n                                        customRequest={(fileObject:object)=>{\n                                            this.uploadFileOrPhoto(fileObject,\"waste\");\n                                        }}\n                                        onRemove={(file:UploadFile)=>{\n                                            this.uploadFileOrPhotoRemove(file,\"waste\")\n                                        }}\n                                        fileList={this.state.fileList.waste}\n                                        disabled={this.state.loading}\n                                    >\n                                        {this.state.uploadLimit.waste>this.state.fileList.waste.length\n                                            ?(<Button disabled={this.state.loading}><Icon type=\"upload\"/>上传文件</Button>)\n                                            :null}\n                                    </Upload>\n                                </Form.Item>\n                            </Col>\n                            <Col span={12}>\n                                <Form.Item \n                                    label=\"机构制度\" className=\"must-upload\"\n                                    validateStatus={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.regulation?\"\":\"error\")\n                                            :(this.state.fileList.regulation.length>0?\"\":\"error\")\n                                    }\n                                    help={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.regulation?\"支持扩展名：.doc .docx .pdf\":\"文件上传失败！\")\n                                            :(this.state.fileList.regulation.length>0?\"支持扩展名：.doc .docx .pdf\":\"必须上传此文件！\")\n                                    }\n                                >\n                                    <Upload {...this.uploadFileConfig}\n                                        name=\"regulation\"\n                                        customRequest={(fileObject:object)=>{\n                                            this.uploadFileOrPhoto(fileObject,\"regulation\");\n                                        }}\n                                        onRemove={(file:UploadFile)=>{\n                                            this.uploadFileOrPhotoRemove(file,\"regulation\")\n                                        }}\n                                        fileList={this.state.fileList.regulation}\n                                        disabled={this.state.loading}\n                                    >\n                                        {this.state.uploadLimit.regulation>this.state.fileList.regulation.length\n                                            ?(<Button disabled={this.state.loading}><Icon type=\"upload\"/>上传文件</Button>)\n                                            :null}\n                                    </Upload>\n                                </Form.Item>\n                            </Col>\n                        </Row>\n                        <Row>\n                            <Col span={12}>\n                                <Form.Item className=\"license-photos must-upload\"\n                                    label=\"营业执照\" \n                                    validateStatus={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.license?\"\":\"error\")\n                                            :(this.state.fileList.license.length>0?\"\":\"error\")\n                                    }\n                                    help={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.license?\"支持扩展名：.jpg .png\":\"图片上传失败！\")\n                                            :(this.state.fileList.license.length>0?\"支持扩展名：.jpg .png\":\"必须上传此图片！\")\n                                    }\n                                >\n                                    <Upload {...this.uploadPhotoConfig}\n                                        name=\"license\"\n                                        customRequest={(fileObject:object)=>{\n                                            this.uploadFileOrPhoto(fileObject,\"license\");\n                                        }}\n                                        onRemove={(file:UploadFile)=>{\n                                            this.uploadFileOrPhotoRemove(file,\"license\")\n                                        }}\n                                        onPreview={(file:UploadFile)=>{\n                                            this.uploadPhotoPreview(file,\"license\")\n                                        }}\n                                        fileList={this.state.fileList.license}\n                                        disabled={this.state.loading}\n                                    >\n                                        {this.state.uploadLimit.license>this.state.fileList.license.length\n                                        ?(\n                                            <div>\n                                                <Icon type=\"plus\" />\n                                                <div className=\"ant-upload-text\">上传</div>\n                                            </div>\n                                        )\n                                        :null}\n                                    </Upload>\n                                </Form.Item>\n                            </Col>\n                            <Col span={12}>\n                                <Form.Item className=\"building-photos must-upload\"\n                                    label=\"房屋平面布局图\" \n                                    validateStatus={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.license?\"\":\"error\")\n                                            :(this.state.fileList.license.length>0?\"\":\"error\")\n                                    }\n                                    help={\n                                        !this.state.hasFileValidateError\n                                            ?(this.state.uploadSuccess.license?\"支持扩展名：.jpg .png\":\"图片上传失败！\")\n                                            :(this.state.fileList.license.length>0?\"支持扩展名：.jpg .png\":\"必须上传此图片！\")\n                                    }\n                                    >\n                                        <Upload {...this.uploadPhotoConfig}\n                                            name=\"building\"\n                                            customRequest={(fileObject:object)=>{\n                                                this.uploadFileOrPhoto(fileObject,\"building\");\n                                            }}\n                                            onRemove={(file:UploadFile)=>{\n                                                this.uploadFileOrPhotoRemove(file,\"building\")\n                                            }}\n                                            onPreview={(file:UploadFile)=>{\n                                                this.uploadPhotoPreview(file,\"building\")\n                                            }}\n                                            fileList={this.state.fileList.building}\n                                            disabled={this.state.loading}\n                                        >\n                                            {this.state.uploadLimit.building>this.state.fileList.building.length\n                                            ?(\n                                                <div>\n                                                    <Icon type=\"plus\" />\n                                                    <div className=\"ant-upload-text\">上传</div>\n                                                </div>\n                                            )\n                                            :null}\n                                        </Upload>\n                                </Form.Item>\n                            </Col>\n                        </Row>\n                    </Form>\n                </Col>\n\n                {/* 提示信息 */}\n                {(this.state.alert.show)?(\n                    <Col span={12} offset={6} style={{marginTop:10}}>\n                        <Alert \n                            message={this.state.alert.title}\n                            description={this.state.alert.description}\n                            type=\"error\" showIcon\n                        />\n                    </Col>\n                ):null}\n                \n            \n                {/* 按钮 */}\n                <Col span={24} className=\"section-buttons\">\n                    <Button onClick={this.prevStep}>上一步</Button>\n                    <Button type=\"primary\" \n                        onClick={this.saveCommitmentAndNext}\n                        loading={this.state.loading}\n                    >\n                        保存并进入下一步\n                    </Button>\n                </Col>\n            </Container>\n        );\n    }\n\n    /**\n     * 组件完成后请求获取申请信息\n     */\n    async componentDidMount(){\n        // 获取申请内容\n        const applyResponse:HttpResponse<ApplyContentOrganization>=\n            await ((new HttpRequest()).get<ApplyContentOrganization>(\n                `webapi/apply/getRecordInfo?applyNo=${this.state.serialNumber}`\n            ));\n\n        // 失败跳转500\n        if(!applyResponse.success||!applyResponse.data){\n            this.props.history.push(PageError500);\n            return;\n        }\n\n        // 不可编辑跳转审核结果\n        const {applyStatus}=applyResponse.data;\n        if(!ApplyUtils.canEdit(applyStatus)){\n            this.props.history.push(ApplyStep.RECORD_RESULT.routePath(this.state.serialNumber));\n            return;\n        }\n\n        // 处理文件路径拆分\n        let {waste,regulation,license,building}=this.state.fileList;\n        waste=ApplyUtils.urlStringToUploadArray(\n            waste,applyResponse.data.medicalWasteAgreement\n        );\n        regulation=ApplyUtils.urlStringToUploadArray(\n            regulation,applyResponse.data.managerment\n        );\n        license=ApplyUtils.urlStringToUploadArray(\n            license,applyResponse.data.businessLicense\n        );\n        building=ApplyUtils.urlStringToUploadArray(\n            building,applyResponse.data.orgFlatImg\n        );\n\n        // 设置显示\n        this.setState({\n            ...this.state,\n            data:applyResponse.data,\n            fileList:{\n                waste:waste,\n                regulation:regulation,\n                license:license,\n                building:building\n            }\n        });\n\n        // 添加窗口关闭监听\n        InteractionUtils.addWindowCloseListener((event:Event)=>{\n            if(this.state.saved)    event.preventDefault();\n            else                    event.returnValue=true;\n        });\n\n        // 审核被驳回，获取驳回理由\n        if(ApplyUtils.needLoadReject(applyStatus)){\n            const rejectArrayResponse:HttpResponse<Array<ApplyInspectContent>>=\n            await ((new HttpRequest()).get<Array<ApplyInspectContent>>(\n                `webapi/apply/auditOpinion?applyNo=${this.state.serialNumber}`\n            ));\n\n            // 失败\n            if(!rejectArrayResponse.success||!rejectArrayResponse.data){\n                return;\n            }\n\n            // 找到最新的拒绝内容\n            let rejectContent:ApplyInspectContent|null=null;\n            for(let l=rejectArrayResponse.data.length,i=l-1;i>-1;i--){\n                const current=rejectArrayResponse.data[i];\n                if(ApplyUtils.inspectIsReject(current.status)){\n                    rejectContent=current;\n                    break;\n                }\n            }\n\n            //通知显示拒绝理由\n            if(!rejectContent) return;\n            notification[\"warning\"]({\n                message:\"申请被驳回！\",\n                description:rejectContent.opinion\n            });\n        }\n    }\n\n    /**\n     * 卸载时删除窗口关闭监听\n     */\n    componentWillUnmount(){\n        InteractionUtils.removeWindowCloseListener();\n    }\n\n    /**\n     * 输入信息修改，设置是否保存为false\n     */\n    inputOnChange=()=>{\n        this.setState({\n            ...this.state,\n            saved:false\n        });\n    }\n\n    /**\n     * 提供给子组件进行调用，修改机构中的设备信息列表\n     */\n    equipmentChangeHandler=(equipments:Array<ApplyContentEquipment>)=>{\n        if(!this.state.data) return;\n        \n        this.setState({\n            ...this.state,\n            saved:false,\n            data:{\n                ...this.state.data,\n                equipments:equipments\n            }\n        });\n    }\n\n    /**\n     * 提供给子组件进行调用，诊疗范围修改\n     */\n    scopeChangeHandler=(scope:string,description:string)=>{\n        if(!this.state.data) return;\n        \n        this.setState({\n            ...this.state,\n            saved:false,\n            data:{\n                ...this.state.data,\n                diagnosisSubjectCode:scope,\n                diagnosisSubjectName:description\n            }\n        });\n    }\n\n    /**\n     * 上传文件或者图片\n     */\n    uploadFileOrPhoto=async (fileObject:object,key:string)=>{\n        // 上传文件或图片\n        const option=fileObject as {file:File};\n        const uploadResponse=await (new HttpRequest())\n            .upload<{url:string},{applyNo:string}>\n            (\n                `webapi/comm/uploadFile`,\n                option.file,\n                \"file\",\n                {applyNo:this.state.serialNumber}\n            );\n        const {uploadSuccess}=this.state;\n        uploadSuccess[key]=(uploadResponse.success&&(uploadResponse.data!==null));\n        \n        //上传失败显示\n        if(!uploadSuccess[key]||!uploadResponse.data){\n            this.setState({\n                ...this.state,\n                uploadSuccess:uploadSuccess\n            });\n            return;\n        }\n\n        //上传成功，设置已上传列表\n        const {fileList}=this.state;\n        fileList[key].push({\n            uid:String(fileList[key].length),\n            name:option.file.name,\n            size:0,\n            type:\"\",\n            url:uploadResponse.data.url\n        });\n        this.setState({\n            ...this.state,\n            uploadSuccess:uploadSuccess,\n            saved:false,\n            fileList:fileList\n        });\n    }\n\n    /**\n     * 全屏查看上传的图片\n     */\n    uploadPhotoPreview=(uploadFile:UploadFile,key:string)=>{\n        // 获取全部上传的图片元素\n        const row=document.querySelector<HTMLDivElement>(`.${key}-photos`);\n        if(!row) return;\n        const imgArray=row.querySelectorAll<HTMLImageElement>\n            (\".ant-upload-list-item-image\");\n        const imageList:Array<HTMLImageElement>=[];\n\n        let currentIndex=0;\n        imgArray.forEach((img,index)=>{\n            imageList.push(img);\n            currentIndex=(index===Number(uploadFile.uid)?index:currentIndex);\n        });\n\n        ImageViewer.view(imageList,currentIndex);\n    }\n\n    /**\n     * 删除上传的文件或图片\n     */\n    uploadFileOrPhotoRemove=(file:UploadFile,key:string)=>{\n        const {confirm}=Modal;\n        const {fileList}=this.state;\n        confirm({\n            title: '确定要删除当前上传的文件或图片么？',\n            okText: '继续删除',\n            okType: 'danger',\n            cancelText: '取消',\n            onOk:()=>{\n                fileList[key].splice(fileList[key].findIndex(item=>item.uid===file.uid),1);\n                this.setState({\n                    ...this.state,\n                    saved:false,\n                    fileList:fileList\n                });\n            },\n        });\n    }\n\n    /**\n     * 上一步\n     */\n    prevStep=()=>{\n        const toPrevStep=()=>{\n            notification.destroy();\n            InteractionUtils.scrollToTop();\n            this.props.history.push(ApplyStep.RECORD_COMMITMENT.routePath(this.state.serialNumber));\n        };\n\n        if(!this.state.saved){\n            Modal.confirm({\n                title: \"确定要离开这里么?\",\n                content:\"未保存的信息将会丢失！\",\n                okText:\"继续离开\",\n                cancelText:\"取消\",\n                onOk() {toPrevStep()},\n            });\n            return;\n        }\n        \n        toPrevStep();\n    }\n\n    /**\n     * 保存后并进入下一步\n     */\n    saveCommitmentAndNext=()=>{\n        //基础信息表单校验\n        this.props.form.validateFieldsAndScroll(async (error,values)=>{\n            this.setState({...this.state,alert:{show:false}});\n            if(!this.state.data) return;\n            if(!error){\n                //诊疗范围选择校验\n                if(this.state.data.diagnosisSubjectCode===\"\"){\n                    message.error(\"验证错误！请至少选中一个诊疗范围！\");\n                    return;\n                }\n\n                //上传文件或图片验证\n                const {fileList}=this.state;\n                let hasError=false;\n                for (const key in fileList) {\n                    if (fileList.hasOwnProperty(key)){\n                        if(fileList[key].length<1){\n                            hasError=true;\n                            break;\n                        }\n                    }\n                }\n                if(hasError){\n                    this.setState({\n                        ...this.state,\n                        hasFileValidateError:true\n                    });\n                    return;\n                }  \n                \n                // 发起保存请求\n                this.setState({...this.state,loading:true});\n                values.address=(addressPrefix+values.address);\n                const saveResponse:HttpResponse<any>=\n                    await ((new HttpRequest()).post<any,ApplyContentOrganization>(\n                        \"webapi/apply/saveRecordInfo\",\n                        {\n                            ...values,\n                            applyNo:this.state.serialNumber,\n                            equipments:this.state.data.equipments,\n                            diagnosisSubjectCode:this.state.data.diagnosisSubjectCode,\n                            diagnosisSubjectName:this.state.data.diagnosisSubjectName,\n                            medicalWasteAgreement:ApplyUtils.uploadArrayToUrlString(fileList.waste),\n                            managerment:ApplyUtils.uploadArrayToUrlString(fileList.regulation),\n                            businessLicense:ApplyUtils.uploadArrayToUrlString(fileList.license),\n                            orgFlatImg:ApplyUtils.uploadArrayToUrlString(fileList.building)\n                        }\n                    ));\n\n                //请求失败显示错误信息\n                if(!saveResponse.success){\n                    this.setState({\n                        ...this.state,\n                        loading:false,\n                        alert:{\n                            show:true,\n                            title:\"保存失败\",\n                            description:saveResponse.message\n                        }\n                    });\n                    return;\n                }\n\n                //成功后转入下一步\n                this.setState({...this.state,loading:false});\n                notification.destroy();\n                InteractionUtils.scrollToTop();\n                this.props.history.push(ApplyStep.RECORD_STAFF.routePath(this.state.serialNumber));\n            }\n        });\n    }\n}\nexport default Form.create({name:\"recordOrganization\"})(RecordOrganization);"]},"metadata":{},"sourceType":"module"}