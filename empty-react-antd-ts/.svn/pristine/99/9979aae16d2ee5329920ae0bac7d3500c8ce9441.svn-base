import React from 'react';
import { Tabs, Form } from 'antd';
import StaffDoctorsAndNurse from './StaffDoctorsAndNurses';
import StaffTechnical from './StaffTechnical';
import StaffOther from './StaffOther';
import { FormComponentProps } from 'antd/lib/form';

type StaffManagerProps=FormComponentProps&{
    /**当前的申请单号 */
    serialNumber:string;
    /**是否禁止输入 */
    disabled:boolean;
    /**内容修改时处理 */
    onChange():void;
}

/**
 * 机构人员管理
 */
class StaffManager extends React.Component<StaffManagerProps>{
    readonly state:{
        data:{
            [key:string]:Array<any>
        }
    }={
        data:{
            applyStaffs:[],
            applyTechnicians:[],
            applyOthers:[]
        }
    }

    /**
     * 页面布局
     */
    render(){
        const {TabPane}=Tabs;
        return (
            <Tabs defaultActiveKey="doctorAndNurse">
                <TabPane tab="医护人员" key="doctorAndNurse">
                    <StaffDoctorsAndNurse
                        serialNumber={this.props.serialNumber} 
                        disabled={this.props.disabled}
                        onChange={this.onChange}
                    />
                </TabPane>
                <TabPane tab="医技人员" key="technology">
                    <StaffTechnical
                        serialNumber={this.props.serialNumber} 
                        disabled={this.props.disabled}
                        onChange={this.onChange} />
                </TabPane>
                <TabPane tab="其他人员" key="other">
                    <StaffOther 
                        serialNumber={this.props.serialNumber} 
                        disabled={this.props.disabled}
                        onChange={this.onChange} />
                </TabPane>
            </Tabs>
        );
    }

    /**
     * 更新当前人员记录
     */
    onChange=(key:string,staffs:Array<any>)=>{
        const {data}=this.state;
        data[key]=staffs;
        this.setState({
            ...this.state,
            data:data
        });
    }

    /**
     * 获取全部人员的信息
     */
    staffs=()=>({...this.state.data});
}
export default Form.create<StaffManagerProps>({name:"staffManager"})(StaffManager);